#!/usr/bin/env python
import sys
import numpy as np
import json
import numpy.matlib as matlab

stats_to_keep = [7, 15, 19, 22, 23, 24, 25, 26, 27]

def mag_func(s):
    return np.ndarray.tolist(np.array(np.matrix(s.strip('[]'))))

x1_step1 = [
        {"xoffset":mag_func("[0;0;0;0;0;0;0.0691521565902343;0;0]"),
        "gain":mag_func("[2;2;2;5.73284623960209;4.77506387667949;5.39128041995259;2.14857886190492;3.46052845373869;3.51959729112496]"),
        "ymin":-1},
            {
                "xoffset": mag_func("[0;0;0;0;0;0;0.0700397327039092;0;0]"),
                "gain": mag_func("[2;2;2.00095793086932;5.7820297402784;4.77510723250418;5.39127621293902;2.15062951647935;3.46047762128126;3.57502318518594]"),
                "ymin":-1
            }]
b1 = [mag_func("[-2.0138249161242263163;-2.0358129395781263682;1.8518820685508197155;-1.1035645101569786508;0.68934315975041948743;0.65822381986338773796;-0.72312710761094656231;-0.57577158018150831342;0.41584861973546216607;0.00012002286910322017451;0.28390629097514186174;-0.43326210689259703202;-0.38592188753399098156;0.63876684734610822414;0.95961121633096890804;1.4164948262802357082;1.7158601535952553441;1.6395835060481884771;1.7642453123438928131;2.0781719928719484258]"),

      mag_func("[1.8144348055220402838;-1.7796073360700381816;-1.3013588627832843869;1.3343705299710117984;-0.86053541559354296275;0.91315834141095875154;-0.65820643202139395012;-0.28783456772334053975;0.028069312479895042883;0.020810279995816659271;-0.15980008534465109382;-0.20026452740771952254;0.4920837315669885359;0.84191288457676694001;-0.88782810524733102309;-1.137646743847042341;1.4743000681570566091;1.5535167112113996701;2.353371786971355295;2.5408584188494653944]")]

IW1_1 = [mag_func("[0.85555024778921784367 -0.98253337333243762064 0.6475759852418335738 -0.3941921035409036711 0.66941125337625662084 0.31229249732621450208 0.1139307252016223404 -0.69897339248215284435 0.52437063547238094152;0.58686778444871667837 -0.071331241840477066507 -0.42961523730454992398 -0.47107833650014668825 -1.357426633735859367 -0.81733654769552521735 1.4753105919480016262 -1.5341912667795554182 0.51941793438981209707;0.30413566258786256524 0.39231600108335090704 -0.30659358545496279147 -0.81096253071613666474 -0.96435595225947834397 1.674060950972811268 0.14837440656016639973 1.5081532585037011884 0.69359020150851469211;0.2202845445499626853 0.28519027321284118326 1.2020911368777102979 -0.34987300950623323459 -0.26518802708031002924 -1.421785314763740482 -0.33456767048229707484 -0.22103017441702138557 0.80507486583366327793;-0.91204978984075291137 -0.52160101787903900838 -0.23639658980212457928 1.0759087391172743597 -0.64062876607341201485 2.0326788639088686494 1.2096512775357299851 1.2614177194460400866 -0.64877960257269751132;-0.90364068072027958767 -0.60865121408533606751 -0.57397905551142780478 0.77400363445416253683 -0.59370845088204826645 -1.1790716606747306816 0.6726664378040445591 0.067044757258343704032 0.077726839190375929256;0.3323543177217539446 0.23736459354641001318 0.70343656513821717358 0.31275848938357131424 -0.20017671576068218897 -1.309369023679596733 0.11657343318156952738 0.30114360491439001732 1.6797070555257933577;0.95740758297877837091 0.0091798443399119487862 -0.66410448417473633143 -0.63552127553566284401 -0.45513294234145784678 -1.4697986995105667418 -1.1902600696989780182 1.1477729092543682565 -0.60706602374397045097;-0.82812391140832541936 0.49410704382234943433 -0.24641423530923714513 -0.040284501383061672997 -1.1941672067358213294 -1.2626693179739978401 0.73991979273412000762 0.26800318217189628145 -0.091909599695485302839;-0.4738633880818343691 -0.48037942874459976794 0.067476553229821795155 -0.54643770137939018383 -1.2428452944659194035 0.31398848653896377359 0.74574359008570390017 0.10379976141125921152 0.31079774105223334502;0.61247394014850298216 0.044035393107197576268 -0.23522163197450274286 1.3548695753485822113 0.89083227608826232036 0.49400851681584889707 0.27352941036625794125 0.33808980573959812599 -1.5651629495641983247;-1.4000660912109881284 0.40590479713557175989 -0.22612251515009249014 0.62231649422459067722 1.0340243103514132894 -0.90730662652781335353 -0.78975963411661187497 -0.21123086495484591496 1.0626450733329166898;0.017327218053479708643 -0.75428396605848957446 0.46132276034876928961 -1.4754606159212828587 1.4204220255371589055 -0.69991740242800570826 0.65972198877622301172 0.39832367466506379827 0.58615102087266979236;0.92625940023070763019 -0.046805881784765683562 -0.094054589135009594725 -0.50364755093339663716 0.24382716354340422393 -1.4434141178315249565 1.0677828660978059272 -0.13594449175206033131 -0.12578385746957013169;0.057581700554217310484 -0.061393481785564377184 -0.98501840340175383925 -0.087882305162848825542 -0.92907616366116219098 0.096349144140055117957 -1.3486433041067436012 0.53529718039716600586 0.56527034603418435665;1.0179703768979682099 0.71180935643832810023 -0.41377488695927083784 0.77028254484438518634 0.17027166445419095187 -0.13521734002660029672 0.1675144954604467773 1.5585283699447662897 -0.79923283396983813009;1.4189603781651860537 -0.8780257798300419303 0.6674594375232686394 -0.059639118958470321852 -0.15223236891840166707 0.84799136018929610614 -0.60814174733398440598 -0.57363573082180263629 -0.41439908217422727343;0.97458954664203589768 0.13385627875090133632 -0.62715154269156547784 1.2613628603245397031 1.0078405676031252369 -0.19649285949570208243 0.0035231204185523171818 -0.55069384118875885914 0.84400412274573888283;0.69535611383098838711 -0.92708635663298644136 0.77745372793677602896 0.85442716338098168016 -0.98617031134241361912 0.27843771352902058069 -0.6389138257277331423 -0.45685652595587922242 0.093422785957688686542;0.72739826158651488264 -0.055109104459362803774 -1.1647928193240901784 0.029756651434975418813 0.15984885994743183724 1.1002979277700377647 0.57089467540566662951 0.69393861495810826856 -0.14805025142313374409]"),

mag_func("[-0.20544663323087716811 1.065477010565685001 -0.33438102907141764586 0.041588366730574519159 -0.83362656703848359019 -0.93476704332307247736 0.051841082276888231228 1.1224758457806378598 0.13843217485767833619;0.18292340869567919048 -0.08941475748537673629 0.09491214384542052962 0.56568685872562196604 0.67194818151027646547 -0.72801984302775946123 -1.1476654928102432152 0.46387568685305985428 0.76741591849972656814;0.39294365431195105165 0.19026614236702660277 0.39204708941240368203 -0.5157792501681537356 -0.86532835756782411352 -1.3885770247514193088 -0.28917406059289274545 0.65091682554955299089 0.88638138536688126923;-0.37720594362164966418 0.99635230503092242493 0.31614151378033356066 -1.3239230756707740522 -0.75079782106207249015 0.80342070761009409807 -0.79579361368954149025 -0.33353257018531240474 -0.11515282990687930598;0.7135406609480090534 0.80313501635390993627 -0.77947199371321684858 0.077985646747664560952 -0.96865679368408252881 0.67275577174062195507 0.056252585037079139152 0.41782283542410736388 -0.30745809821105712922;-1.2882384547319061241 -0.17868411343405626868 1.0129760573191231021 0.70803671653047484114 0.12896434091462335991 0.53701054217099752908 -0.5988033440594423551 0.40832329900356034713 1.4079059150937214273;-0.22257770990412217849 0.24809995215831173732 0.43925922668069133925 -0.60215417064739273911 1.1784236265215883854 0.75785803225369741121 -0.16465685097565399553 -1.4206280638645361059 -1.0683042396586175382;0.10018877581414159517 0.10366126710252920873 0.39882263720347382874 0.9174730437797294913 1.1706352035521920829 0.92871849709002063378 -0.59216008813858256321 -0.72517270415915002779 -0.22484079884606986144;-0.58433313041990864178 0.051500657745303941859 0.56572818657128121078 -0.98041986608898035183 1.4091660422180760648 -0.98317880033482296653 1.0871548126216219465 -1.0419686122373852388 -0.54422012915926665233;1.2772134879177030609 -0.93543160171369765798 -1.0332203160458341973 0.69112454493619501772 0.5991380397619793241 0.079502482491294851341 -0.21626500298684700474 0.39663257888246972183 -0.19695044883914394895;0.1538366527621742863 -0.79091346634156123319 -0.16357135644249251594 0.6521148549401751815 -1.0611857602783980603 -0.2164699055781570125 -0.00107144708747894217 -1.0794624891061237459 0.58569064908406898162;0.11112813408591130926 0.32751076881878049551 0.79250381031827354938 -0.4106737144260564909 1.2168008656557858238 0.88112937026058246737 -0.32109310027239540419 1.1991284552325494062 -0.93912592794717153488;0.50806040399177765376 0.035958416586431278528 1.0087319871797919557 1.6842793803815365727 0.10577595265014627657 -0.48721964905922221512 -1.242565838461383132 0.82230134745273220087 -0.9798684966529798146;1.1390716996343976941 -0.70886274567264029312 0.19172318661136547591 -1.6403395957827202611 0.011664917309042767413 -0.18649953003150063213 0.42762507848583958259 0.44618090762762957491 0.1067789122210660302;-1.4149153773784590715 0.061866645817254754813 -1.2204990335439378502 0.54731142872003224475 -0.14010818109911990503 0.0055240998943757637502 0.93567079207473213831 0.2252971296237224752 -0.41621827649090081813;-0.41765580310567879119 -0.86666334503872966 0.078146850091798045201 0.50617965147998411624 1.0206926133177998128 -0.13514141746914251629 0.83526134905283078158 0.10892089208965165248 -1.2146187139078223893;0.056879790482011111097 -0.26744154359109190144 1.1470254832553330449 -0.51668343379480885513 1.3809141549696521967 -1.4803897854971324044 -0.2388094237189341551 -0.64964087800446590482 1.5536889872406827173;0.047590940179534378662 0.053217586387180139396 1.0454934892701275295 0.49368971243157122597 -0.011136851079340179954 -0.71378078652699217255 1.1796979422098876622 -1.4684867535216961087 0.37144989435962677549;1.8083486408195006412 0.17389052278010500019 0.079251347488125511997 -0.22633125931351180671 0.86476973316862115748 -0.041137991598369769153 0.33498015750657783585 -1.6199285116569146492 -0.67499855862383151273;0.48017860748015223082 0.68384073703784253873 0.79444902753523249928 -0.54706270814281854342 0.41270281543767717292 0.46912763907586596535 0.13965717411505174095 0.92767106803764809442 0.10584235221514722014]")]
b2 = [mag_func("[-1.599735851185974278;-1.4609733714752777267;-1.4221443608665420566;1.0141872811116166009;-0.97423590293968487241;0.75384067553289790808;0.73718482707383348185;-0.22885760001012783738;0.2472359977253215102;-0.0010760355366056079639;0.018333597264696716023;0.29866715893257972381;-0.28516849318598008756;0.77148408256237344105;0.91396462568803604753;-0.89792773363910194373;-0.93537994613177122272;-1.3266353676434303743;1.4937138458581231681;-1.601679273268906023]"), mag_func("[-1.6872630385587230606;-1.4595403673824722812;1.2582287517964292345;-0.96030035373397415466;0.84693990478955261114;0.75500112571181821064;-0.66042724117379469906;0.51353815268802327498;-0.2030878323702863808;-0.12900338300326377738;0.026443550331080697274;0.16277233915052072288;-0.42138325238994384092;-0.5265605695000666886;-0.49276142451079163465;-0.9387782609417946178;1.1874716416096997573;-1.4160038792539015873;-1.6497327362550233687;-1.6825354474439657704]")]
LW2_1 = [mag_func("[0.32034234625950119835 -0.34657148704355261737 -0.94902850707711983169 0.0057403571218575350985 0.90103782148511202266 -0.4088844621002177826 -0.43755306003451926999 -0.19412970862853526355 -0.31272104674526618462 0.24152034771349559228 0.39225833359983974802 -0.48327030256589276203 -0.23559745491184522215 0.26607715444086554868 -0.55323023958528871891 -0.25902112424754009101 0.45030100384399252 -0.15108877076435933695 0.55766172640752775802 0.43094054430166367498;0.52786467237807843667 0.085175515858879141673 0.30782086480644532678 -0.88233838879582293657 1.2418124344987002683 0.47906038349889301653 -0.58277130240133379058 -0.12742055250803294153 -0.30508967415470533702 0.40170646917777741436 -0.31542417311135600988 -0.19038273600167737731 0.28845627424772601888 0.52089383029503555367 -0.13519098264725090686 -0.83630953726218226763 -0.99125915914956530539 -0.19799271171935012292 -0.070687383306375597969 0.05112414844397467073;0.64799552852887298826 0.030635447594355765671 0.16326442468781127149 -0.089773799768282563916 0.05966327149368814281 -0.30596177081238118411 -0.073689934099452819583 0.42826642167299916464 -0.49354588622319806035 0.41976742846132064635 0.65240761727407958759 -0.094230957944605314713 0.24233660698066059047 0.42341321067089376928 0.56073831604220403246 -0.1459181452837349513 -0.39759213321748015924 -0.23343372927065358935 -0.49000965871672580443 -0.30733074892834311154;0.045301469790486235956 0.014032527404577933156 -0.6562088827635392807 0.019590041341008640474 0.30527235360151044885 0.41292969577486438038 -0.37545444287124413174 -0.14625883773167969171 -0.21948647812088639686 0.18517037315481668647 -0.4054612829446778699 -0.50294934752052222748 0.12139369819479348123 0.46000825759406804849 0.49063568071082236388 -0.32847148897707389992 -0.60295787131055789132 -0.42619960001914453107 0.15272218953343563719 0.56272284747751222245;0.3376883210872285157 -0.015836196629259287338 0.23874237391805050446 -0.020189516753788251668 -0.30507152093921446889 0.53311633711874051311 0.26711251791608137118 0.79259491569860884841 -0.38457056130370120828 -0.2629827054695023647 0.051428347331259137432 -0.24582765980395293592 -0.1799148760882427478 0.2806400006458456553 -0.44546323909782198358 0.58644900233607299977 0.076904053530562593854 0.261898299124579792 0.6569341013014274866 0.044253318403212477117;-0.11012498863003059024 -0.350652478019015168 -1.1626304516841505787 0.030269780195155124303 0.130952476840078047 0.37622311698442406636 0.66304028907946421789 0.066584504578546852005 0.79090520995100033197 -0.60577959876169507059 0.79625687244652987307 0.31380455419535291384 0.30552004594513404445 0.13913438450960308179 0.688955627291499062 0.41188854260521351458 0.39859405320243757043 0.47485061995684396674 -0.25023210593543904201 -0.090894748405204117692;-0.68248129283057301642 0.39149485638503001006 -0.63425622658976477108 0.15145958642276519113 0.34690558641562468933 0.5360984043816303668 0.42035206780536299442 0.056486719387177850016 0.4530437668402474416 0.43507676458978117306 -0.21698241131432954854 0.13811033594116747802 0.033860097436676832305 0.31298083379767044354 -0.19376871311845927925 -0.19991734316121281823 -0.01321154955078698845 -0.35991306429885383533 0.043982727080863259772 0.011279887712134886377;-0.15880537318875390107 -0.808119687728236058 -1.3061044900186331574 -0.010725184102289713611 0.78620511772489931612 0.029415918641675052603 -0.40458980212630968332 0.27456264917714723328 -0.63039009280982405414 0.15441102943910742229 -0.20321008409236693271 0.18407127339673678978 -0.067377353354009628106 -0.22474279067400346199 0.14255610314877925626 0.31295920282055966766 0.38855112804242575297 1.1376794376363685846 -0.54078939822236204993 0.067812362596507788637;-0.27179470516940201774 -0.19897918243785847614 -0.23907479465474010261 0.2689303146134597311 0.035932672553305712582 0.10702493155123535273 -0.35587007894821087728 -0.32614280235018211496 0.47962569465802140645 0.073623663385168972018 -0.78408578975845732995 0.16814971223322236482 0.052856487417022444963 0.22677456455087438569 -0.32608565816725892939 -0.57547639601434297241 0.89740612627400151435 -0.035193497726450459484 0.55150931449522921923 0.59896753794426194073;-0.096204641923978831408 0.52517219685356042458 0.51871664482481150138 0.0063808396481713648002 0.45980874450834807732 0.36560332919438187638 0.064830952468847971581 0.32580116036347883668 0.016978011727037434914 0.30941924436195178405 0.80880858592247029115 0.24326953646136237341 -0.12288977802196861255 0.20822429649524501483 0.38206789912837979539 -0.47014159417831863363 -0.25854228142894947196 0.27792931203088383496 -0.16335218234613735344 0.33187304933685080055;0.29437052274941977181 -0.23020142727497691637 -0.30579424157753687386 -0.4644835772510652605 0.21191160876715220418 -0.47458444266953297985 -0.63455678882493538051 0.42847626684296369337 -0.19901708582397423242 -0.31182571646106993501 -0.28881559721487715109 0.77976637662330694489 0.64786308215713583891 -0.28677671833260293122 -0.076801380109506087179 -0.24549094728911469154 0.4515736866786344561 0.99449686201152365239 -0.10697446234772636786 0.13267166511250144678;0.14094039709468692001 0.67671562547972885504 -0.44696919452210198687 0.061476800007802819004 0.17920697189609124944 -0.12490695811194219011 0.48704277579426724643 0.27413361505488026415 -0.42969213898437830235 -0.32544089526226238629 -0.3154942220564382338 0.79319393626793799346 -0.40706338656143559174 -0.567481174092227314 -0.63825387436160418986 -0.34649732479776546024 0.1073875649883768435 0.27083926563580096314 -0.42344196250122090319 0.12666601162426846527;-0.59867036725481748149 -0.28360873057202884429 0.14271105366768138678 0.60787001538642826404 -0.51818127234006972071 -0.14328381146487761955 0.19969635516075565085 1.0446069847198455882 -0.47902726769128800566 -0.47163234873486525878 -0.10316240352440525507 0.71588395567166718259 0.90952440737308970498 0.66211030386863722885 -0.29036399808117768773 0.61539937620768336846 0.25659097488698340284 -0.13734320471418842713 -0.0017568393926664553975 0.25841141157152175412;0.35212576245136012476 -0.76765481777942601305 -0.51725468190087875442 -0.24541649810463098125 -1.1573414810918600804 -0.28170838837986322822 0.60658278674705667921 0.57571720425493477791 0.42199328537960456575 -0.34210517430410786188 0.15237435056379750042 -1.3368406377975730059 -0.22656438464517547615 -0.78272590661543894885 0.32178783506063224351 0.46174647963909254411 0.12824701679273495247 0.16309346312365194387 0.13129427374169261311 0.26109142000874180356;0.15355339997409525599 0.39970766786392875058 -0.75693898475532794823 -0.60983716249810793197 -1.2748040883878122287 -0.26917736138163050885 0.20908219490306409472 0.14966961276218859744 -0.19637283863058174749 -0.035718551546188498369 -0.60863076062416021639 -0.18759784915767865887 0.46880281816898727865 -0.056012622436727207975 -0.29802697108191622544 -0.14186220102325095005 0.78904139670081474556 -0.44754664745759770161 -0.36001537101966868404 -0.16240266949294490662;-0.093706023016925085733 0.43725749955850312656 0.27053824938262066579 -0.38150256291440765022 -0.40763128369914458649 -0.25510303160493452701 0.62623575275929066475 0.028156805106844096098 -0.51809390603166183276 -0.26685457577865057122 -0.23334996259066512203 0.78726705823174791821 0.10013429700678661005 0.064041509717288586101 0.27739968238011031287 0.51905565207718962206 -0.73465719441460242134 -0.4273258131789576808 0.15818134529722424619 0.014296408365792835291;-0.81869253209411130268 0.041109524014678010262 -0.29831783598640743138 0.58048550830796197264 0.43742318415780995222 -0.37792073511051005319 0.59952450642052601548 -0.59189197909591129143 0.32027800911825787811 0.30759657907883963812 -0.5940474119695369204 -0.67669253488295000309 0.041169520253671640364 -0.45653014869769659168 0.61061862079807083248 0.28763803386528652428 -0.23544638668057535358 0.44240488434954905461 0.41523370866949965707 0.35845404571817945927;-0.22894389751989668857 -0.69078301074131309711 0.66306193656063505681 -0.71825616321984442347 0.52765296194262700791 -0.24013611909933288424 0.32459723960117253805 -0.21307119988499123586 -0.060877761530625837394 0.24613191867099307175 0.13062423252736707346 0.24584065602914753623 0.34606866835290017725 0.26546787990958575776 -0.56286341328157074582 0.93403432975976841135 -0.30085189097236064715 -0.24957662558854754042 -0.0064425704153468592306 -0.46043098260499226715;0.07659422292612190486 0.87257483831953441822 0.99513735766056898857 0.65461208160399153577 0.82927758608173418597 0.91509712932324505097 0.07712378412059391064 -0.78490488959647564116 0.099581669124214247657 0.3653943498953897695 1.2572301761493831496 -0.60417937358895590361 0.22199903492004785521 0.30757266449127451668 0.026643804281264879541 0.35670546660260360472 1.0931213834634925242 -0.53213529009372839695 -0.68218012631631519405 -0.68757517530557055174;-0.46019387966963004599 -0.12100341869630630576 -0.27347079999621126678 -0.4516258145695959958 0.32247043769999111928 -0.27394361700769420676 0.24936708822032341293 -0.45994027921243840762 0.31059950141884223873 -0.4939269560234281764 0.0008164340337342174559 -0.39002706038860213145 0.51228165774321621218 -0.48636278104641395004 0.34804275932684292094 -0.46117888112428895298 -0.093122411543068162043 0.35014647212482780114 0.54902548326780931109 -0.35333079472372663776]"),

         mag_func("[0.34148703011116848804 0.62155089167359001134 -0.63417960462794609189 -0.47808724005686453751 0.029319455592720363585 0.45415949443774050742 -0.4731674044116638278 0.24098223498579476876 -0.1925926399138588041 0.4552506994280541841 0.40021946620364634573 -0.20938151712283212258 -0.74946563562407109149 0.31358972228593501308 -0.19894957171051100286 -0.52503960909624336484 0.72535749590087572614 0.042642738445712070894 0.1720891187988281279 0.15933522449606557503;0.75666920638575452251 -0.0042839268197100875343 -0.37358148264822138573 0.5773515422877382175 -0.15809442265201414934 0.18227916719978401461 -0.20947703311862947428 0.29987662239822526766 -1.0766289535873687644 -0.2494577229455658407 0.67810295387810981538 0.23576740348935026903 0.063086649931335031516 0.65632568408221603207 0.28042140989958735942 -0.52208357028902707686 -0.21693775126707970369 0.44018406943779020413 -0.88701429679777565873 -0.71770158709186571144;-0.39545843435702532354 0.52243345551425690587 0.4647657060457079381 -0.29787732135292982472 0.56023828402738540255 -0.22734064159546596429 0.038181252751363144171 0.13378161968903307111 -0.02194602993421042314 -0.14346643672635109312 -0.52696229273083361466 0.5395393620187411976 -0.57172893757568721274 -0.25718110744332334239 -0.42802136307911553548 -0.28543385732894133167 0.51609510693671689641 0.0647421291310170538 0.75527471014628166923 0.746483957487452221;0.089411422342220991943 -0.57180990202995807259 -0.79139416525331296448 -0.047526101463121833701 -0.099671905950147923758 -0.54002688852874070058 -0.063175217333861694025 0.52094577844363154639 -0.50268754648827995712 0.15651702877420839433 0.98322318153899279647 -0.11404604986304472947 -0.25248693730284793579 -0.17506260389736069683 -0.2978495312503903758 -0.45453718016092681253 0.54640046814857157198 0.68087087861237638453 -0.58952417988181538 -0.0015759288812262489676;0.031664432476618542545 0.36246319044237101936 -0.10672034873708596825 -0.46533786919395331294 0.40752458206941538643 -0.77711038988252356674 -1.1873273145078591106 -0.38723838657907699856 0.37376472611547895131 0.46655630877074272256 -0.54809269873147015151 0.3378765617599489568 0.00020662308619108244595 0.64035522346326301246 -0.29937875294431709472 -0.28149421989878337103 0.43306433065175203856 -0.48910762014354580707 0.97974514150104685672 0.17570240156414090871;-0.45302860658489341183 -0.10416195844889644673 0.1361439908036529145 0.64692383290249966254 0.61619631498793903113 -0.23329532040165790185 -0.44135683455840557521 0.5275218626930076038 -0.75354937687113843214 -0.74866215966060467579 0.63801839457966325053 0.4386691751198889544 0.57809156332417799273 0.69097659048093784673 0.053756032219572619235 -0.12284615519541609852 -0.69808859148673829687 -0.019681423978860263652 0.045094198207517255383 0.22204585698053655451;0.1917376852218388994 -0.031916549235286757746 -0.065008673849453427196 -0.033301568537671889791 0.092770111960897946868 -0.96878717765449218202 -0.068457966415566784413 0.52446630395221605081 0.38303426500960946477 0.16298355213304571709 0.54518801488024726254 0.51281201973700774044 -0.32874307158284882258 -0.30880783347809170891 0.52302107620840299074 -0.023381175678874422524 -0.38000369918909410183 0.4170745934266281707 -0.94142283537181059572 0.43523827419941713002;-0.50312641694479853793 -0.15444781535692644892 -0.27080552393369500264 0.32483034285973372279 -0.26134817806157056852 0.14387513617311811776 0.25944287969556317774 -0.22879697559845543764 -0.44261159092666552128 -0.44359589652610598165 0.38495707449453364646 0.048318962888573999126 -0.78761883298054979896 -0.079903254949158189491 -0.78829253829799950104 -0.71473648906031728156 -0.65398679366055201267 -0.084732479335295124434 -0.90368761935377550643 -0.13497374792742450333;0.36156534434618359253 -0.46870498932118082047 -0.46426588532634599504 -0.39505095518263205756 -0.35241621608944440069 -0.067297465200962844345 -0.40222608720062164034 -0.39480334846824660655 -0.46640393552925113463 0.17173209827491184298 0.31543202921821372753 0.32094175108607808644 -0.33097592066708331204 -0.38464488448052569503 -0.32624094973960049426 -0.39220295633299345761 -0.072502214038733053814 0.62872872258398704304 0.42895916788628252192 -0.41333003932782719225;0.028829435292856017692 0.68675682431013407303 0.47115154071245690659 -0.26488050798709483757 0.061218501273198284995 0.63977175171379385699 0.28144766057750875143 0.43434293802996926104 -0.38504477387360075413 -0.3942589347780857123 -0.76912837605603767699 -0.22474724067112902826 -0.38436015714566912349 0.011873151080884927419 0.13096968744838941023 -0.17887856312247105151 -0.14640354904728933305 -0.1831367502185877183 0.054363673173387798421 -0.11383858243512821884;-0.53086913490397868998 0.11416807687893008871 0.41557718551394495776 0.56323444909731734676 -0.14120720436886669003 -0.1174023718544084105 -0.12198983360880474858 -0.10469371712649025441 -0.44099257296744426293 0.76308746666949323068 0.2524439320085128946 0.82004128949099863721 0.89266403887502965286 0.40351221291537753277 -0.039523505103445329134 0.093950265806260438439 -0.9576253843967612589 0.92655908058308844577 1.1277035521886393798 0.29732568943866000133;0.25848617599135653711 -0.058390516565038193264 -0.054563846334009867556 -0.18321750438485434609 0.073119404616433597566 0.94443706566896401533 0.57112625720528842344 -0.27392524996703065954 -0.80482420129001319697 0.54341145593079154263 -0.7666764901743242655 -0.12917290336308334675 -0.26169974973725956824 -0.56963868199402101222 0.25642063526576680532 0.16403143868946878925 0.056186750384919312284 0.56861520964757983343 -0.8537245482647878303 0.80326328625550169615;-0.28949049420192690674 -0.23723621938058719882 0.78564872947679098569 0.28527326827765481232 -0.31069751469277490097 0.28712601022671413453 0.88294426782647728036 0.47034338503365952233 -0.20221875860170918093 -0.28327213562267278268 -0.15641422792616152537 -0.047410161652712071167 0.19209994577430208884 0.070763889032776042254 -0.15434126884509333233 -0.30475377532422165405 -0.55563903707616246752 0.33351945379693731519 0.425882300163814842 0.0959379071549197604;-0.43972219702875181557 -0.31634989489675457985 0.37028748703628633354 -0.037422633671850551174 -0.42359750003731477808 -0.74219048591608394183 0.3485323382890791466 0.50044408010878693727 0.42869162626380236114 0.7291951684140337564 0.46125472029714814637 -0.5305708933745041378 -0.4483173003506744636 0.53018740754186932662 -0.71023143492437745827 -0.29043669427410734318 0.49755857268679776206 0.39834791441984895854 0.064491478582885272686 0.86982877697468397038;-0.2876181416507939681 0.20800094623292955665 -0.30409786385260528796 0.4424397251932544739 -0.39052784655332833941 0.18100028340128471172 0.68722061532776812509 0.19740681359450470977 -1.0121698275322523752 0.17524453557953559302 -0.071785732197435503377 -0.36474467391291165441 0.15220648430961755682 -0.98504846485627584052 -0.023877796180623227923 -0.31848163358908804232 0.54958644933737621496 -0.18700940474629010324 0.25063622182717931741 -0.46778564420940377255;-0.43073242427403596322 -0.32351416079975892082 -0.47494054242021732648 -0.1824518649419312466 0.54122271171703828507 0.3262403010583045937 0.911765475090244637 0.11074845359242631304 0.23505874441918206408 0.015734408643108734743 -0.24131383886421300944 -0.5470585134529846183 -0.95749938187954641844 -0.15205959694889764622 0.021483820729739467464 0.011716152688238053864 0.031216441596805439423 0.54018344450254607292 0.81888683298568509805 0.20567167715555698115;0.2980899710737892061 0.38691600805530584894 -0.83935988309867104462 -0.33695405804340650135 0.32979142692831464601 0.62214663246113433015 0.079747223759991769931 0.1936473301083888876 0.31575347991469315811 0.7367498772922418393 -0.44717905047936634677 0.15641376096523829098 1.2438576059761838888 -0.78606568239842178336 -0.15443392089918778209 -0.042002056939692417048 -0.092023642481595932519 0.13028994747793026798 -0.056135124309392922526 0.40034931998077011306;-0.19715561715234286577 -0.022882727138165286779 0.36920593951771485397 0.57635517797251456518 -0.26122047468394438141 -0.50919182136304241837 -0.565967650352054652 -0.36485256497364276784 -0.43505960047184288886 -0.033448114442775761512 0.72389491440285869128 0.56008962158538977416 -0.36521472180125702511 0.033762765521455871676 -0.70340970382528811289 -0.94377217609141672572 0.37919492843234708923 -0.73844974345190417253 -0.63279085597743589542 0.74108794093727092811;-0.11444746933881982942 -0.2034633741716126154 -0.22175333235948058164 -1.1233051259510387077 0.21950735248444677716 0.3371761868582293098 -0.57665511476512276712 -0.16180944356375723259 0.054369486866167417161 -0.092929181956057385627 -0.28542750099720015644 -0.31391091107982244113 -0.3290318506793083464 -0.010244293609577480308 0.75041642257158658325 -0.70448004520437390585 -0.74073955954264580903 0.2817187148138011743 -0.083845650310369904123 0.069416729950712421915;-0.44107850698871120532 0.15885543919012201641 -0.068759775930030270219 0.34644690551981360827 0.63327365693157477988 -0.46832691325796454995 0.22166872218655667148 0.22205940272848070927 -0.63542686007494530998 -0.13606801052022426957 -0.3744737626890443094 -0.42379330622967559261 0.38002732180483095314 0.47921557909644146855 -0.34316742116241033544 0.45332434837727164645 0.10547330867719216518 -0.34023714152620243567 -0.088306535174850445125 0.11910230850323649809]")]

b3 = [mag_func("[1.5886540555539763186;1.5594347935657351112;1.3211030380155919239;-1.1518912207401472703;-0.96231275802924709506;-0.76651914890328176622;0.65536450541670676628;0.45298162743740894021;0.22861878671386698381;-0.015855474903687830773;-0.19056252737064963143;0.29398549229226189627;-0.34873580966162009975;-0.67817151972790379322;0.6665726521391203141;-0.92294479227235304286;1.1644625449463927858;-1.4864817014299631648;-1.4742323673038610909;-1.6736881777340864019]"), mag_func("[-1.614585984264288232;1.1701125142882127239;1.3968317753508596724;-1.1519662439667348597;1.0071540679551900244;0.76530323594930427245;-0.66699817026908636564;0.47317384310034488193;-0.34138453312571437337;-0.004025695321632741415;-0.19242418318992962623;0.25025678383071314759;0.35138695311840312252;-0.40608522435854649268;0.81638980995895316095;0.89788317159078934182;-1.1265647369201552408;1.2899081582925400191;1.5758962009487424982;1.6912887699227139304]")]

LW3_2 = [mag_func("[0.076172276186309020862 -0.25022909120940567407 0.18132042844011178606 -0.5476739304276077025 0.21914482151926270581 0.042491023455733550884 -0.08033425990628378921 0.38020418934153182855 0.44915402141611748821 -0.69423280256682162737 0.57094065577446462267 -0.3686186254564337017 0.11886581973579510296 0.63289450432253269163 -0.47739738234795925376 -0.38672618856963286715 -0.52286059852019417526 0.089407491045805059793 -0.34538842245348216897 0.23095137575774019045;-0.11899434580667150874 -0.1792473386830587545 -0.15498681280332959886 0.28678716538025061933 -0.30153978835636102707 -0.58363330912366617742 -0.455777589619269341 0.3921027433854466504 0.59599265700215686703 0.37315380607800235913 -0.25889034688381329374 -0.056543978796179471258 0.24363372350324880022 -0.37590511679068294715 -0.37252158469552615339 -0.28262429706416192232 0.19359585725530964462 0.4719267675006450502 -0.042256690462366554295 0.35249488407679369084;-0.096782901512847546721 0.50802572248544419775 -0.53602872720420602359 0.39768271373134739255 -0.1897704752335560574 0.056932917269595872956 0.50803881790529814566 -0.059210346363945370873 -0.380318966794948643 0.21603777730361159448 -0.28539089968029218713 -0.61591003699777602254 -0.20761249258891537051 0.00013540771727472067018 -0.36426159508637945272 -0.40641289079934328488 0.40569749759912293596 -0.54602951400376065205 -0.3888001225232035063 -0.099262395294874863905;0.4512899979480631818 -0.65616579301216260145 0.72180509130436842913 -0.42699323673444689042 0.037666636116579978177 0.054095363567325645271 0.31112698365532148737 0.24755238892065076217 0.069205787433801152497 0.19752489626527147681 -0.32026390959632239364 0.51036765654655780189 0.21986867949951249823 -0.055629155172913273553 -0.19614534061849114854 0.5365155060193332881 0.46101309119990024898 -0.14792591795878914929 -0.23636851498281014061 -0.22421989971852354651;-0.081452692534509735234 -0.33022598817543308281 -0.44538616132087394117 0.49731480826425439323 -0.15163061870922420193 0.5506026663619746353 0.3395049201367587588 -0.3535969242382820954 0.4661384946013397701 -0.16139450697750834518 -0.28931500885249966659 0.51726255254623487723 -0.76984104878156700558 -0.43310334139393025232 0.85884675378898245324 -0.072270845280459947158 0.86993950569767697356 0.41256997792291194571 -0.80418169102867709253 -0.14978919515366140303;0.079286939367316913718 0.81073964043706048255 -0.16341017334073068556 0.39551750102775434792 -0.17471402846310596368 0.62293716769474150041 -0.63985685592206198447 -0.77310885706112442151 0.45117456002848738139 -0.063066676927624326643 0.59611841515753449805 0.57932658647534773788 -0.98894220230637075453 -0.31533757253739369553 -0.60123235299496924355 -0.01187457457468110017 -0.84111075315611449899 -0.17190828972435451272 -0.57399508284527545054 0.096589565157621376512;-0.07505188920065325453 -0.39746588340118188531 -0.5882659533114130701 0.44481827259140122033 0.48925289258719834029 0.55848246970915216281 0.11247897281529523061 -0.30429457400184722893 0.81907679417809675648 -0.53899309006518947296 -0.44080809206942139777 0.38566284596064309698 0.0083244379854558805953 -0.16769929726643242884 -0.064864905199144187731 -0.18772331845799875016 0.12796425481726594886 -0.35569044095423302254 0.43982416192915108066 0.11445145915828876249;-0.093120723128314666917 0.19749284746864351203 -0.094983449425161084467 0.20007034533559153733 0.56583701209665127063 -0.29310925778555146914 0.70913056128174267734 0.23419040662366774619 0.61952762761395185898 -0.38342579055707098901 0.010808257401913094753 -0.73120516419496639493 -0.15842650281390413536 -0.053955785809087337956 0.29239062047123021149 0.14037467488237387325 -0.48498222875107399599 -0.18327920130152541844 -0.57365058904068755297 0.16618532183677262037;-0.29915493676122717481 -0.67734715334858175417 0.28252755782487048997 0.12247402458443334972 0.50366147375064962421 0.31841526256072300027 0.33243441223415454155 0.57317798106726880469 0.18235597308981701947 -0.41243107779248444622 -0.81898405432174647967 0.31890580710453203528 -0.74557429248394846422 0.74376771307672007172 -0.027169560563602618286 0.13515011870403867422 -0.27098388041432985851 0.12734896107912990759 0.37731275249790091619 0.24026677835912133019;0.50451244343369239242 0.17934521415379217624 0.019955938407275705671 0.41942100837111806477 -0.00011988600359022624428 -0.63361189418704377818 -0.29540615124599056696 0.24659012263276292032 -0.064972163480010142189 0.3821805770042079331 -0.47963141858130348139 0.58337611706001268885 -0.43445212821866840969 -0.04170772396860589204 0.1562362550080832746 -0.50075128509734490034 -0.70171754008592324148 -0.26765029449260896444 -0.58244286925988653092 0.24445199355158467314;-0.5161818200317532801 0.89014210881839295197 0.70849895944655050251 0.48263292640118715671 -0.23925800038124744873 0.04801559297669671933 -0.39407308733875862083 -0.66301002304947997956 -0.12143409725092781104 -0.12387170051208808152 -0.61211684402565536001 0.46769094423433488217 -0.40562053175578849373 -0.22627242244322859355 -0.043224407877830994806 0.37254972753145709774 0.73319052767942294313 0.76208881486852209086 -0.75003265774908756125 -0.38071703921093130729;0.19596748588897097698 -0.45286665695790739861 -0.43491969665741869733 -0.47074299148031795159 -0.73617932163820487546 0.48994115322810682933 -0.054894655848423123956 0.19511409351121825062 -0.066746254735475379904 0.47120573724890563172 -0.31028587922339379013 -0.38994638746323201373 -0.2955738455675305798 0.18153248420785197959 -0.022808655552210628514 0.32596081364417278659 -0.2694893460464400925 0.41304864937478313891 0.24803292048336111897 0.13160478414420817561;0.139149441755221287 0.92133284295546502563 0.36308615993548826184 -0.10413658657968812016 -0.69937963533495306478 -0.020756397254517049145 0.10755367521060496538 0.32289616480497013162 -0.39999140205448313612 0.46073159054247081468 -0.074446899768208243953 -0.12984048878973436514 -0.39227477730301685277 0.018344913456992240075 -0.045791062465838215656 0.27615802532802247171 0.19094947347480287214 -0.70783813709523368818 0.69870900826739668066 0.52759797020641052701;-0.56471319473663639243 0.85301768190592741625 0.5362980097962444237 -0.0083020637895217883756 -0.34903455649478759559 -0.30594858774601724205 0.050025443431020756579 -0.55586419434163847342 -0.017426995741536797924 -0.34527523815594574064 0.4035482055465897111 -0.18310281046866391796 -0.12144990330693589131 -1.3971288313755867438 -0.65212589371078000244 0.22763427625923413067 -0.13959336536388705641 0.75086541460986844232 1.580725888474897145 -0.54252370091247292816;0.16638132642730357746 -0.41188725632542755317 0.47108183272468717728 -0.35209888288781082677 -0.33520453328199567578 -0.4721765745334433606 -0.25757786356050499377 -0.37421135677706507394 -0.057128751750297600276 0.081223831711618496576 0.41122034477386509854 -0.54545471702466807873 0.28234319999715695726 -0.58786769336052369095 -0.31084394310669927197 0.46092795137724767995 -0.68432615486668979532 0.29149255212668329085 0.815719567020090075 -0.26057412440960059374;-0.77026039272617419229 -0.83939094396693891831 0.2251781199818131407 -0.32408916496938294793 0.58078734747985771847 0.7578249087361474956 0.20531115358327431397 -0.8666429905755967944 0.31846193155347007897 0.37970561451727957714 -0.55769753668960020399 0.1518472274123294774 0.31936273301395051716 0.75110633596994813566 0.83560040587366024578 -0.26022180575981029849 0.078437682523924523448 0.038179445927122176996 0.43211106764406986835 -0.25880429964100137852;-0.07617495818599354096 -0.53489471875001781687 0.2137641998532606169 0.016805245136448071497 0.38021205790898021659 -0.67357919139637356665 -0.2849334687772447916 -0.39227312849307255371 -0.12945765788817106823 -0.4654548687405505869 0.75442036967052228391 0.32688359366409269757 -0.16018860402696627476 -0.1867887545507552205 -0.64795436234374814699 -0.43761581366491153489 0.44107408110004159285 -0.10855538864870163673 -0.48253772139736539337 -0.06297371985871833;-0.048967462062509882481 -0.55086113556500393429 0.95327172211596922224 -0.0017117203835255914018 0.32166513568051346983 -0.15773497627576349434 0.15477888914768697659 0.33467901527022808628 -0.13560735823390537846 -0.33907766018653412443 0.067783565496446443466 0.25524400570677302502 -0.35807125178563509182 0.3300789959107967575 -0.092876860967268576319 -0.1321991916344025797 -0.57580837787933680794 0.51234097459307248457 0.07722261486498509242 0.29509444003854368166;-0.50783631806658369179 0.54045949888512512249 -0.19538159799658877391 -0.62574433071539781182 0.56341387788491614774 0.65464882654057754419 0.2821865114319618284 -0.2429191682846957856 -0.32261619844892486242 0.3126544559632122855 -0.70389297015828378168 -0.29581057788441206258 0.12679071717872544833 0.74857360496174729647 0.45235206568699626306 -0.55115119381029809009 -0.42898857608234802763 -0.21739468080309110043 0.36532593179311217968 -0.10927578172154582548;-0.62054948090372041847 -0.56952634814922387108 0.50125120791335131543 0.33844660661057812678 -0.14336836671869052084 0.46697246722255941753 0.27635927891689410218 -0.3193174379642378935 0.036469230980524305896 -0.393129871215184723 0.78545665506502881925 0.42984739428370821734 0.68959391051256846428 -1.2126966851433307326 -0.89256513162898687419 -0.42289484614957639774 0.15471771055577879239 -0.046244763513408268518 -0.38479929534467816055 -0.40663641425303920229]"), mag_func("[0.1425900894657844975 0.86816137068811605193 -0.51664497632949479833 -0.13729800166464439792 0.084195807864824417921 0.457612987544020966 0.93050343114382294551 0.17738847458141376867 0.098130171038216029711 0.35406374077091690156 0.41474301125978524363 0.15903168470513248667 -0.13316461492798506439 -0.51210705581519611052 -0.70170007106915055495 0.42366990480549904241 0.1217373820841641946 -0.56908926481964772215 -0.34894490530401434114 -0.33097717778842505876;-0.27337033313435993298 0.44774986685208895132 -0.019972495824409443321 -0.50197926098953815632 0.546085638059127354 -0.43182227397341327313 0.010231683265902286398 -0.20286442500432344538 -0.20622153401086451563 0.26056151318991871424 -0.79055008501832901846 -0.3162191130310334497 -0.24466445248136836632 -0.17883440129740374447 -0.69732024577670803644 -0.041449409885947405274 -0.58978280618755019038 -0.27599385248275498661 0.61016934863596483662 0.7280269733051533132;-0.34985590030468904921 0.27293612565872504838 1.001841706974167634 0.30641954880751109958 -0.29244855974046385372 0.4784632485515762923 -0.70153914461082711451 0.58272835127886046802 -0.2562013553589453374 0.07442124609938327584 0.65051092082666617245 0.53970982008550216769 0.27175198210434731161 -0.53543998304076978467 0.267337336828687544 0.13383424411474637017 0.085895389609168829037 -0.061824087918940617836 -0.51971359396052829727 -0.36125611142417418664;0.19946094363828287266 -0.70417165632185940716 -0.31573493367026661538 -0.047975193419271359996 0.23994842901711971317 0.0032611375606522463068 0.0003324356400121516314 0.36584937352791807585 0.20097166790496212574 -0.098179748420771317807 0.24026540387347752881 0.61956218535967388927 0.68393746771496144454 -0.44351358420426195694 0.62350410521609744841 -0.00064802823789094732114 0.00044707167517619452422 0.19847530521369191603 0.314235364121690397 -0.54646528304848396296;-0.082988820691204417956 0.15816248939543378627 0.30102780287747932242 -0.12267703575067219479 -0.36905712039330346164 -0.16037401460154601662 0.43282720671930241529 0.56747263928588009829 0.63202914797335107977 -0.084306078480447466106 0.16007575812676880234 -0.768672341362929612 0.16169335450155650213 0.34212892237904773962 0.20460309327709441662 -0.206325978157283485 -0.18862910596723744816 0.095493760006220243519 -0.039541907782308434449 -0.64188923021304589156;-0.55812842610134372201 -0.73772276863181673878 0.73126604080672885644 0.54760715379718183371 -0.50540344919915614064 0.33106657177053006036 -0.19025224365840873175 -0.47361893969714374819 0.57026405621873910157 0.017329998809661753545 0.3970189320226810703 -0.23584828156298415225 0.13182585208241895391 -0.61680560817161589338 -0.29139771534833847078 0.51730753855468336599 0.081379149671173586778 0.28148281307882239144 -0.19518672391381952647 0.36637059333216787094;0.16876059380385757813 -0.67241338779403714287 -0.53594625259348904756 -0.53958545644048949708 -0.18652923171235277766 -0.40445619964117252021 0.14576816026831043716 0.056786509763572183551 -0.24335428553518875794 0.20185330989600880347 -0.45716777306573824768 0.58967157272600412288 0.1353908454540987405 0.36452290151295974052 -0.40169585379278299753 -0.10759879897449156627 0.18373034361300480399 0.54379778690600877322 0.46252256753520704091 -0.032216542597304956286;-0.76428877010003037906 0.50386114825989847255 0.67138937418860522577 -0.43301448474757137097 -0.23413395363276279237 0.83301998197729121287 0.32574635740195356792 0.27101437600614441958 0.37752184002765165616 0.3688660453678785367 -0.29121263660257939998 -0.55764607734094162605 0.38479453774372440744 0.47045410549731714323 -0.29110972088977915551 0.52028534319666619457 0.4296260629287426136 0.45288512683123549607 -0.21559673860464367845 -0.14956723792992590583;0.58710729638019298893 0.65985966221727410108 0.35289143617805562858 -0.0014700226765820656287 0.64122832100256310639 0.22901249435511167318 0.02656952622499052924 -0.80066634313409112966 0.54932624702966559305 0.17254858166795564167 -0.13601115441789690674 -0.57084930211134576883 0.015271159908245207637 0.21709462831468598343 -0.52374032389275493315 0.40697572730789033368 0.0799161975988633283 0.76826013238741908129 -0.65473749752660004297 -0.47856665381744223353;0.039189470157908898318 -0.8087355093175959686 -0.47068701086569508796 -0.53955725638288432044 -0.53265321307343849178 -0.51120912912248650528 0.59218518813377540866 1.0080448159081614179 -0.50117256368977880499 0.06407468484934190911 -0.90847509467457265853 0.013102682244609389212 0.6672243921557496904 0.98518679194129932242 -0.51666467829857076755 -1.0138551520594962785 -0.71435385746573454302 -0.39722752469428340705 -0.19161920076128621804 -0.40400574670024252955;-0.13115648186558462318 0.016232971574173488821 0.50685617179002750987 -0.16580121372174957961 0.60734259932789969039 -0.021703053852590321188 0.59343581767626096823 0.36566266160144228481 0.42720995686333773644 -0.11359771757282054183 0.37780613448529953846 -0.43481400330721198255 0.15070928236262587374 -0.21357758910105470451 0.51695081920539098785 0.10510285296914664843 0.68502212792657413143 0.44093753642372590651 0.29512627615701614303 0.2021588907900754295;0.53712775184941441431 0.1761604440769017621 0.081732862310589238231 -0.45192905747783818082 0.74027526549957178847 -0.57769923113251431257 0.18232059694337118816 -0.63035734501507534322 -0.031752283429463068476 -0.4231221092145819318 0.23597770347753216358 0.59902572705139855991 -0.71688769363295801185 -0.54481014414977835258 0.12949089313058947948 -0.30587574932391131677 -0.57470293577359254922 0.20706627749971340258 0.26464959922770658896 -0.36268166590466272003;0.16604366784134136359 0.58099894791614981049 0.47146242288714113045 -0.47759433680067836514 -0.32380751993958040158 0.39608135322642951115 -0.38863989804666210226 -0.42386174421899414089 0.19984541803146474437 -0.10541810286582449507 0.53972905877298338329 -0.98727323190683125009 0.38209935396885602588 -0.65534543541389811416 -0.2728402995057739866 -0.1944733081113705353 0.21417835644260388439 0.03184267596333523187 -0.30981443813011200206 0.64739046235238328908;-0.28432298997300931021 -0.60479547950656420419 0.17769757031550295623 -0.38089900991132336072 0.57432613721660208395 -0.16595679792989712076 -0.74128161649859225513 0.6072234931149658177 0.21312260293282805912 -0.13547846306924105075 0.18002026608169843791 -0.16123496979353990621 -0.41764793290948387661 0.20086239958770032987 0.42531542477144335113 -0.75653707031265460259 -0.97586144672579000492 0.29137767460423291688 0.17299384163983275164 -0.66599268977661263413;0.27067750420582648019 0.28723553535296542094 -0.85396858958615218249 0.36599401062302228116 0.54457658887537219172 0.13606908589841548718 -0.69813344974955904298 -0.35750407155337809995 0.15554761252848300912 0.54479320803235609105 0.73196108779892377072 0.49860652292319818102 0.72755969122456343179 -0.03424333450612519758 -0.3160582334560843587 -0.37861209510373372567 0.21860148516399885432 -0.071694727949104419817 -0.19108278410567039463 -0.14293726883724436338;0.52861976901559803999 0.65141123662870048516 -0.13426588459264929276 0.68855598702725906435 -0.55406027027681614694 -0.075874408720762606673 -0.11698940760057213728 0.30142752726152544085 -0.83287625524956387935 0.072822404950998495532 -0.47411658402823397829 -0.31247724223686129674 0.85744195441674297964 0.19007472419981730205 0.48490621716238219152 0.11087393485290097939 -0.053747573348667448956 -0.1279487539203598423 -0.15051479303617704142 0.45408947644320929449;-0.098941258015613806065 0.17994546202630973264 -0.28291009778403919395 0.87851418282659099468 -0.3347236137994026306 -0.60899463559742206265 -0.63048967164288560738 0.19524040781262130828 -0.11795040985607228856 -0.42611164306140347779 -0.11682972483428669119 0.1883052361166296651 -0.6013872355169699313 0.36158606910125662415 -0.42284343630126114411 -0.030000134324269688707 0.69218172061039162646 0.41738533062359323145 0.048522882039991353798 0.11593197466341796653;0.43603623042264960663 -0.47993528403162416529 0.49998912740858508785 -0.60446012891499101283 -0.058768766154215841546 -0.60344933889706597885 -0.57425108343301212166 -0.45764894311451470577 0.070959259794552434486 -0.1889444866557050684 -0.43766622096229440553 -0.5625755082903046711 0.79061461216438311261 -0.46939988333368559692 0.0023255117068113903903 -0.14699042181142940589 -0.088230275317138742719 0.5828627923441329628 -0.73822389557522261061 0.47959221321535244753;0.15575669374682563073 -0.50607825607044387706 0.71298643166689001927 0.51585558288920363434 -0.72103615352305838737 -0.77553161976204798567 0.14781464433944324632 0.06948484989592902672 -0.27106911618461526636 -0.60518032156116530196 -0.38185632041423978045 0.65110644130285544318 -0.48091375710237121988 0.16132488783889875616 0.59521336091707077731 0.58042512765005938036 0.62194841238490550239 -0.72709089275079608061 0.012304517636482700804 0.38856647513555730988;0.48789299458762996897 -0.18730842421618185134 -0.45092872811646023123 0.17097269050733668316 -0.13134384848848210114 -0.022586046602585358595 0.058029074718732601146 -0.33721295143376006642 -0.44535089795801530155 -0.55085645061013099877 -0.59264757660791889116 -0.33443511385061774899 0.31148010023345712449 -0.71240260878169370251 -0.0050007407945009806766 -0.052281568185378608782 0.25599945930362083546 -0.52376990124472810884 0.66011109087334041146 0.124153133095773624]")]

b4 = [mag_func("[1.7451356206625472378;-1.3244413470993221527;-1.2595452847759680548;0.93506300374365658445;0.98396026934875535641;0.74331507057022039309;-0.6940868114825844426;-0.51499944315881396317;-0.22293731080977802206;-0.013435225264878156159;0.047345970824603490767;0.21472023817368679488;0.42130843131181838768;0.66056487756689563628;-0.64742100523300594173;0.91316945921687231458;-1.0409554835455767652;1.2265520506364522291;1.3696246655421346894;1.5933289455306975935]"), mag_func("[1.6617912675751218554;1.5246485503860343069;-1.3503804043070173346;-1.0084946348569665542;-1.0656748258291734999;-0.90929230585171849643;0.64252970150722377163;-0.45165688479024385105;0.28448075756068841313;0.14294946620006515614;0.0054628705720524729783;-0.14935800091222103947;0.29592203131980787667;0.56031878787975064604;-0.73319971565854868967;1.0736005570128768216;-1.2106266624359665052;-1.1907888500454759662;-1.4556792833003515675;-1.5619643951846224894]")]

LW4_3 = [mag_func("[0.038667881687202858287 0.27483527876982566385 -0.43161218892509711775 -0.057907934681432175761 -0.21708235594650954203 0.49278710515622803356 -0.20293248715239309288 -0.43351817571254142036 0.38871496581089182154 0.075359361553374401566 -0.48069378997525114006 0.50350236557703720308 -0.34646871849722132852 0.023133429840949036593 0.65317318045166594676 0.29256151425381898834 0.60015818270896326148 0.091968264989820178168 0.22534089948407767801 0.47750674467019077474;0.41955637610968415929 0.094344285236529393246 0.15456912607839867757 0.27602050684688916871 0.19415101861130365513 0.77723370222696730458 -0.10406996315682567888 0.16357552802188662922 0.58410145468016971826 0.65905111357637280456 0.50831387779771131097 -0.30509237569498165454 -0.47551840629008734762 -0.64896798939952005103 -0.26928818319302466611 -0.40140588569951374254 0.37585656502745329322 -0.0083539951796748092294 -0.30170156134864961617 -0.82464857279257519629;0.2312827024708357937 -0.49824242188933326458 -0.5248599545478916939 -0.22840326803037766523 0.22874976445929240398 0.57328207412678944266 -0.18293373827435369106 0.30365135722011898922 0.016258161639761722905 -0.42954035098227916212 -0.63752079881952372631 0.52512845196993462871 0.057325017189798294082 -0.37663585757757611638 -0.30165929329098561951 0.027402963236636920796 0.46246607405611722674 0.41713255495890250169 -0.22029350322322246991 0.2064821397207467768;-0.3615828662352319478 -0.60440558704398295031 -0.27067004509759140518 -0.36024528981464709609 -0.67692562123169286448 -0.11221871258663798643 -0.73112261077252282959 -0.036215795721523544315 -0.47290543852020866522 0.34709677954774453834 -0.087517745962635756785 -0.2026369411080769789 -0.63788544294649629496 0.21611095386060957813 0.29418149337426080514 0.64252471990533543966 -0.62070543954088741589 0.094732544742356858403 -0.5039136230879039946 0.47920356612256448381;-0.01210295892036117836 -0.20007218303303575535 0.0028979975645126053105 -0.019480732282189411331 -0.63177690995826241149 -0.21182315005539889552 0.32248138010711968615 -0.34819524835993392875 -0.47167663286301320102 0.4906363589669345826 0.29238910101978982103 0.41954627862175603026 0.17609134996602687773 -0.041496032350471750982 -0.31196775579109359278 0.17962425531928782885 0.19281435684543135611 0.35274907106203345908 0.78840078800697677153 -0.54018306280475769654;-0.4078993612602686003 -0.64036158034128753958 -0.26888983408490418903 -0.13096737298062885446 0.96861763992611205065 0.65646031460306919492 -0.15633027231856663763 -0.66459168797333711964 -0.40852069275787145086 -0.17060347243985227172 0.55962211039184217576 -0.15955002376659968566 0.57654673130659128688 0.64299342830215067135 -0.095841547876821170382 0.11623328997383496064 -0.1705898921491299236 -0.082879764033380445842 0.77507278376693722333 -0.2324157198149914838;0.27150846590364935418 -0.024607922426488217094 0.38943977896736692301 0.014437363814648194321 -0.72533712896944602111 0.16237845921257465509 -0.422557420961663599 -0.57785669042811949048 0.29211839176824172526 0.20952853634851459352 -0.63902095153480886758 -0.18902338786358349743 0.69231214066044299837 0.2854972139592416025 -0.3542018081579246247 -0.65843714214106163762 0.25885525664485792285 0.44933061729465545442 -0.083135100544027978886 -0.23316174390475830069;0.49312565889308956901 -0.19881399105585348397 -0.39916725927871166135 -0.36689037858680789705 0.44015197679122097796 0.59247671785380318088 -0.34715618904189610161 -0.47904785130164906359 -0.97793592259667494471 -0.31509259724560612081 0.90252543950465624611 0.31946755188740266762 0.36577489967776299906 0.84459856038834490999 -0.91546191225307538275 0.32145403086048079944 -0.42480349065318878665 0.23801909534379322997 0.43997497590875117579 0.42221834285184134394;0.25567832155703007491 0.54275299672621335478 -0.15810885541852578995 -0.17996425154588649442 -0.080998571261999594006 0.19413717403139257867 0.017418280044049706118 -0.42444613930000180124 -0.23462642244613066134 -0.060468178366683507374 0.52760627421984762631 -0.19176608701017897052 -0.057952880336523841798 0.61855326111664243882 0.83178754180475023006 -0.44053727900442302134 -0.16233174883755677187 -0.47761815695216669475 -0.94523330797008775495 1.4190011707479952552;0.10125581962822788329 -0.16213371950230723306 0.71030099789478995387 0.10659801427053144929 -0.20412629129399872951 -0.48643018968517193201 0.77751661251242842887 0.21947417209888051004 -0.0090662489894789213829 0.49354089021206881682 -0.3573953401159353227 0.047791913029856504525 -0.66659630251966772718 -0.040258219292659318256 -0.17400963676597250296 -0.3480683652788657545 -0.31026071606288280202 0.31504160864429964217 -0.21332140583992628691 0.64291710257056500222;0.40540185955609259194 0.43343730304681948873 -0.45101825031775577557 -0.060115844381295018006 -0.22289922849721480191 0.91378377409682787214 -0.41739545186197257731 -0.48476183445983389575 -0.44310883820356378182 -0.11284672818614858991 0.42750273003197425403 -0.015403169397072768304 0.13159767363069832524 -0.12999256908618869732 0.50552748961093940672 -0.53626484176454713992 0.49669263192038365373 -0.45622713094375022536 -0.63390189634744453784 0.58027059267349612171;0.52408005288387682352 0.54103484868454976287 -0.32100511643332491074 0.41726328858401007249 0.27362672215511696372 -0.56575647224603908825 -0.12589234177327401909 0.010200379758054888696 0.45381142421038322965 0.7460358393213460948 -0.71736478414102089474 0.13961319585491785422 0.9920190366234806767 0.084146600773774130055 0.1332441895030961887 0.25614552187592365406 0.06152072534005309512 -0.3049239822951750889 0.22039737035280801414 -0.23561369524847425305;-0.10822601708576698454 0.37600236532504183184 -0.2548651689359744954 0.28069604372246331758 0.84703664709332493477 -0.4273093601292752286 -0.41857740464152021209 -0.35786155917130224591 -0.0074975158790493781624 0.522631427953562544 -0.2151249314214985775 0.084997380501514438467 -0.19157793264422831592 -0.10889815219322351858 0.070888086189870205822 -0.47082656878068540607 0.48558776993363461649 0.4954102491079832582 -0.6018897096274941072 -0.3059561914910359226;0.33444805881729511299 0.31429930478802881044 0.20628915917503518052 0.11881778076452234605 0.17549312310884210286 -0.46133115038120642293 -0.40170007811703845046 0.12598688762220827675 0.47507255943325876757 0.60610701695568136582 -0.09903409536539387048 -0.051178691955806057678 -0.19574927246829351701 -0.5361579270782779183 0.42882345004948668743 -0.29540171490772459961 0.20686029512416839737 -0.33736469486650821903 0.62734987865427971343 -0.40959372899440371629;0.028135404889693446662 0.61451969016049479144 -0.2093036786267203353 -0.52915816807031890168 0.010879579237287871976 0.47383286293069543094 0.46487088452068259237 -0.2819760073192126848 0.44134321802454595796 0.66833035275644492312 -0.20068601468034832913 0.27554457887907352065 0.3545772934425965861 0.17328417173200352797 -0.60194968696675643649 -0.20917721685460324843 0.17442633437318030842 -0.65210583902725960392 0.12260634996792951767 0.076630147586182750796;0.55710063359383210635 -0.15275298049810975831 0.46601025176875626732 0.20987558480339887912 0.10263793728903979063 -0.53583715080369653805 -0.5810342710683191747 0.22286239804660046282 -0.38633242515355697977 0.29014127829351660237 0.24569377645219991901 0.35559863320703033462 -0.6000975250309443787 0.0061888369530336880681 -0.57332646095101069683 1.0077680869735017311 -0.13618800069754782855 0.25727737137684236757 -0.28835310204613229246 0.20515266865891726433;-0.15181880922170845616 -0.34971507996001727214 -0.21124515894787149195 0.36013644893265489566 0.27360498822156381626 -0.17651304222092664697 -0.24745777778986877138 0.5787058811948113668 -0.23487236185392632026 0.0038696531043220841993 0.69382823518109926209 -0.16052862604372053479 -0.19662395247045930113 -0.37403423488464004887 0.34402272778026460331 0.65493567769662730527 0.55995264609208850182 0.29818833688259221981 0.10433226654003846523 0.20626632239596376373;0.41483302214163403354 0.11852470859048966356 0.32067757026489812633 -0.43367218373522292696 -0.4464036163208514596 0.29581488205295947136 0.26442560260592973265 0.28119404423008936833 -0.22327411524551488142 -0.3658585896444899177 -0.44892437827959641439 -0.53619813775976132852 0.16409514844745959339 0.38899697045702186227 -0.51744303916235223628 0.44919944302145758952 -0.15572041700596722658 0.21286449866521997554 0.43257157660673650756 0.46766697084371916526;0.12154218201294510193 -0.35299907279712783303 0.22497343706749206582 -0.31216442436750241329 0.25695073283733216307 -0.62352779084322573766 0.077646159473053658062 0.54069490381852436389 0.35270204315342862378 0.31243957138276118313 -0.27852736719102172414 -0.28350631142791243855 -0.15142521790351032296 -0.85682384492508034679 -0.4202641568697471075 0.4623270540247833571 0.026543428792343566613 -0.056002221428440801532 0.17155512600246444754 -0.34399960362326703622;0.89536812229795714746 -0.031668881035062546037 0.33708535167749920092 -0.66414947655246092673 -0.082020309365217494713 0.50548395918805510973 -0.13982862300755982687 0.11167094877085756432 0.02586491552372140873 -0.54531471946432641396 0.43871335128355437583 -0.38682250599692935555 -0.28152992818490607529 -0.44425449563255769991 0.073556211197854159956 0.63637495809328803453 0.0059127985903947750945 0.35376822814541747375 -0.45747015110617023081 -0.084065228262478405852]"), mag_func("[-0.77921970696988718252 -0.058598035929140604439 -0.010150465929391215905 0.25805603343159988494 0.58468576474535216558 -0.03882404110541162745 -0.26089986608086634945 -0.067167851923838756134 0.54160369211867764871 0.47112229723921550395 0.44171177556774671169 -0.66580009807408147005 -0.485529702917714856 -0.59446967884541157545 -0.52816075777076321174 0.26168007092404288461 -0.14294537886300517915 0.16185823338049531994 0.58408280018569525005 0.26005123816590008934;-0.35811116821193339499 0.21177985882798039396 0.48330914791354695481 0.41076540727086585658 -0.29616632409059556741 -0.53352915761345320877 -0.28198438147171889234 0.18743780978018398375 -0.79402536010030533298 0.24550573886283633129 -0.33673579306838924419 0.4714134943518705767 -0.35262365251242189235 -0.20575817020877190666 -0.09035805242693596695 0.18241588236726427597 0.25298968324883536196 -0.37983095950040457467 0.86227668489256836803 0.088296830725179312194;0.2237108513798362619 -0.66515941110485921062 0.26312101315740721308 0.49223455203740407171 -0.094778628296965039546 -0.55328473951901124828 -0.28271991528788736892 -0.29867873213938334054 0.086703989669941958218 -0.26387692579157662198 0.34650172501818976567 -0.36198033170327198471 0.06393901049646630308 0.3250493135374564746 -0.60178501256465832814 -0.075068507002610265766 0.31628996591469871191 -0.43456983701650708785 -0.031967883299471346048 0.010206850891993246577;0.49794286934369264008 0.69617889579447611581 0.79511235053321305255 0.53500336688572802668 0.60674401981989856125 0.3529782024624869563 0.30761994390987307257 0.59085743319199801604 0.8439812396184135368 -1.1486640918404340539 -0.24529307244549031219 0.26854256659910813454 0.31704414931020596935 -0.6795666663603171509 0.26227362469345560925 -0.58777236053893489043 0.24744535075016935166 -0.038969388151102887785 -0.030580030707407852147 0.031879897310903702878;0.41449855824147835426 -0.046921196722807666235 -0.52832966995803665178 0.52195478727450383971 0.1426638078325382919 -0.068331606811916634214 0.50419146040220663707 0.18679356661950127783 0.4483188879845259045 -0.37002604304170549909 -0.29928352995563811678 0.30112863849529836191 0.27143686025138191731 -0.29892668601701810616 0.15313220119921544526 0.42653863531739449888 0.3833813577825685992 -0.4793933488920327779 -0.01921311735518308611 -0.37226193099843146728;0.37132458414701080551 -0.7744508406810515222 -0.78454626477158806441 0.37464379732394009759 -0.14769503952979240458 -0.12327368067888400116 0.41465163761001505582 -0.16445427617306318524 0.76391671972281405267 1.1499477271742384321 0.39323193695725444652 -0.25276197736479499856 -1.0425185648544139649 0.24156770148728451408 0.78438545100565315593 -0.5918038571252480784 -0.24623813742131234195 0.063163385265885302333 0.68872019819508600857 0.2844738622918958626;-0.60277067087258906497 -0.41546547798811028773 -0.34284729347497810981 0.61256477827313604578 0.43367967901298770661 0.49054920722315836779 0.28463905893239782596 0.19644607460531807175 0.47528528151558130377 -0.97627474955589488292 0.63542682001492301058 0.28902883594483969043 -0.39367919423350117292 0.55024287862138088201 0.54329685411879868884 0.0062474610637397428106 0.045525836526574679775 0.53938405014190338171 -0.49089635839532536066 0.90745452981708885076;0.22032663704596036625 0.49993172962491794209 -0.32734374234778140789 0.42030333565013555663 -0.46237475972150804404 -0.047086204743742143819 0.57532405760590088484 0.31243796601137840963 -0.012879517863058263794 0.29693043505193117415 -0.20838318954037535202 0.030481624171563061199 0.058824608053999714874 0.28082970640516013994 -0.57050479630022521427 0.2123808575320588754 -0.58095442965960009118 0.41845925189247890064 -0.55869389742145592059 0.015511930651096789494;-0.83641356036610714497 -0.30492074012277198269 -0.16632027158675197209 0.35574491617842307623 0.31065853667777904024 0.46252177219495133054 0.45021773533074377349 0.21673406399451783377 -0.50426667800940205844 -0.33451552806555140407 -0.45990246884947677541 -0.69978366856934837159 0.46660484875306196262 -0.31486079660417215509 -0.15784086968255336969 -0.094290276635825481799 0.16341075176872330021 -0.12999382666769093708 0.016999752839159703449 -0.2360013376989196221;-0.47383696041283485112 0.21005891781105964777 -0.37833562744453841376 0.11965679600390956294 0.14075115102364796349 0.35104495704702842751 0.37032129505244176793 -0.49518612605544592986 0.46214935735138651385 0.31396666232910275252 0.50725803504310174041 0.020536245224297859646 0.018791417203751374643 -0.33266630941896085938 -0.44841676471964975192 -0.86689248396438445265 0.06956791619923294312 -0.3845524181300875588 -0.40739030400660863895 0.35110620664407971026;0.12391668762919129387 0.61735357150021852313 -0.11941217674981688401 0.25179636607549032989 -0.33314403056893732158 0.01498941453092547671 0.73855163068789453362 0.34654254339832091247 -0.43743025094880583215 0.99369583082310686262 -0.06869881188208995515 -0.70207608616529804113 0.13759781670725115821 -0.30750707690716594378 0.19636242863721672935 -0.30541830499227462514 0.6297019859630269556 -0.74629388317609490766 0.75049429952555624102 -0.58457136292968348013;-0.55748771551283049508 0.41554717475081853761 -0.49776054219837612136 -0.75122206738178487484 0.056883420752163092737 -0.63508133274634726018 -0.13737571838681525427 -0.15228880852158838133 -0.40572964770441022342 -0.65606085619904974671 0.32583964069136789332 -0.44426921476026370872 -0.15624730774381223597 -0.32640446081056995187 0.082988443937116324056 -0.12746566502916747976 0.69682741747903254037 -0.26334181215866570014 0.94100332599748515161 -0.53768442740012978298;0.23586850774234738304 -0.42190862816056345919 -0.19877803845577540764 -0.12761714470333918037 -0.11090247254634362506 0.47261195455320331726 -0.40215641698396803472 -0.86484822132707039888 -0.031539830548679335942 -0.27543353258769698311 0.025216569451309438915 -0.30473461709940130593 -0.59415878067922045513 -0.17236002534123259777 -0.61074954174455542422 0.16414316861436670236 0.44603586344882106829 0.31945178208728980396 -0.011152713588966165631 0.006567525730636487348;-0.00028707896513344242223 -0.68069660422185218618 0.017717337552156868508 0.016679324521840052653 0.19935518321117343121 -0.16694664566983494214 -0.68968150810911721393 -0.32713657889285641112 0.43497921792996807611 0.19006072989375302762 -0.08081048091273874967 -0.031073200912271416868 0.4431756597965440525 0.56745922588129094066 -0.17709998430658033253 -0.55436137813700336885 -0.038067468682102832689 0.65486964588600138359 -0.14147639618150165131 -0.377677138559782688;0.067127306626777086263 -0.22286821687641186762 0.52965783062231774903 0.33253581421624200942 0.18373676584739351281 0.35117019273555399872 -0.056526316559103020887 -0.31873089309618901632 -0.42406496332524346027 0.68742153571475017593 0.4883567917716542528 0.32022171076304484227 -0.045542676531163110709 0.51212460869688569698 -0.27776390420592300678 0.50005209881319478971 0.39492920724984337255 -0.61424507215834922569 -0.17305028058840973837 0.63163345340809440298;0.35322883267377463978 -0.33071556840772597941 -0.32029863294245547456 -0.41313485941377986466 0.26588693954788533702 -0.4213994264476513818 -0.19595886468644632683 -0.017494641705115138164 -0.15477727328717841293 -0.77635481327267663598 -0.3238763012147423126 0.19584401561356015731 -0.097731619348894946397 -0.46092921454128982228 0.78097686548692646369 -0.50437486448057844424 0.2555279486269182998 -0.24460390608980947524 0.24894060672985970917 0.28601518193741587437;-0.057013189989707134531 0.51652686004684067456 0.14681929130053575361 0.30628961406221938413 0.46233030837291400061 -0.69635582497446213424 0.55194027756629737702 0.75122748947071971148 -0.055893589489350720134 0.86263251541711916115 0.20759245337450049629 -0.96905739543016555793 0.17477015347018914904 0.2526926248008193876 -0.32190237865001591899 0.71724666363661260249 -0.52786707068724469938 -0.40241455860331054595 -0.031807521869675704773 0.14059797251566491516;-0.25754300908192834241 -0.38160596589086853703 0.62554115198675552811 0.11495711279108229708 -0.18369161570684028328 0.64843856133137101061 -0.19084209975408022997 -0.28406975882620016938 0.13903501977440010928 -0.40046211333723968906 0.11633708943119983048 0.34908808701790317031 0.040917636663606815617 -0.6134075711711276524 0.52044386346252713427 -0.28800773592914330479 -0.56510563057188367697 0.32859856002211274006 -0.20146616265564809556 -0.29247379092477165941;-0.40375731646355245141 -0.35795681654420646867 -0.1383201627734283734 0.0079264343826790494701 -0.024149964907120215207 -0.36020287853807181344 0.53561039756828454639 0.53936083070771623227 0.20758894315786613483 0.49110773586559741677 -0.10694675007863395366 0.055634862140179423828 0.22286731885258087571 -0.5098899472016393819 0.49639583991849145495 0.15713230804831554432 0.19652235299151921133 0.4388328160192010996 0.40387317290023305727 -0.57319025908388754331;-0.59806230527003312325 -0.40278604408566448525 0.51822090858620351028 0.32304426694506932494 0.6317507930052220777 0.65280166016923979466 -0.0023597392043754514789 -0.38511157016592711955 0.091508254321988224955 -0.15106233831090609687 -0.12508179718331888242 0.1452877928648760586 0.34803107226585128231 0.17289342954533426511 0.65828744564707031284 0.041548571698534576824 -0.33396487953793974057 0.68474841702210276217 -0.16937283612954537326 0.47106576368352359729]")]

b5 = [0.79228923142735185881, 0.062782144177813248298]

LW5_4 = [mag_func("[-0.35137318544488643779 0.86406711738747787876 -0.72918223596898346095 0.51407289948036138938 -0.6680969593904843018 0.59725795847612506151 0.97521721081314616253 1.5897885691601985059 1.1613943624863232174 -0.43643128554982968392 -0.59907977164319314856 0.6953536157191132494 -0.65952294388521937041 0.52988519203086748011 0.29693967744125848718 1.0037425221485825055 0.85624757137466445123 0.31648096931113223196 0.52370813068717325667 0.97921049799270765135]"), mag_func("[-0.54408281715414941182 0.41319481406388408606 0.79789028961129382367 -1.0695741821906694646 -0.54134856459757363378 -1.1606236723217027151 -1.0785875763595307308 -0.08487365366099682007 0.42812894538340623418 1.1306263539063214907 1.2633299882259947378 0.83196009066598919368 -0.87781837682075447571 0.32276398891294844073 -0.47885243693117929276 0.46427612285153141425 -1.0401645381317170536 0.3127626579439677923 0.081308511201270944335 -0.52555346514639200706]")]

y1_step1 = [{"ymin": -1,
      "gain": 0.755287009063444,
      "xoffset": 0.027
      },
        {
            "ymin":-1,
            "gain":0.616142945163278,
            "xoffset":0.008
        }]

for i in range(0,2):
    x1_step1[i]["xoffset"] = np.array(x1_step1[i]["xoffset"]).reshape(len(x1_step1[i]["xoffset"]), 1)
    x1_step1[i]["gain"] = np.array(x1_step1[i]["gain"]).reshape(len(x1_step1[i]["gain"]), 1)

    x1_step1[i]["ymin"] = np.array(x1_step1[i]["ymin"])

    b1[i] = np.array(b1[i])
    b2[i] = np.array(b2[i])
    b3[i] = np.array(b3[i])
    b4[i] = np.array(b4[i])
    b5[i] = np.array(b5[i])

    IW1_1[i] = np.array(IW1_1[i])
    LW2_1[i] = np.array(LW2_1[i])
    LW3_2[i] = np.array(LW3_2[i])
    LW4_3[i] = np.array(LW4_3[i])
    LW5_4[i] = np.array(LW5_4[i])
    #LW5_4[i] = LW5_4[i][0].reshape(len(LW5_4[i][0]), 1)

def mapminmax_apply(x, settings):

    y = np.subtract(x, settings['xoffset'])
    y = np.multiply(y, settings['gain'])
    y = y + settings['ymin']
    return y

def tansig_apply(n):

    n = np.array(n)
    n = (1 + np.exp(-2 * n))
    n = np.divide(2, n)
    n = n - 1
    return n

def mapminmax_reverse(y,settings):

    x = np.subtract(y, settings['ymin'])
    x = np.divide(x, settings['gain'])
    x = x + settings['xoffset']
    return x

def formatRawData(x):

    result = []

    dtlbs = x[6]
    if dtlbs == 0:
        dtlbs = 1

    result.append(x[7] / dtlbs)
    result.append(1 - (x[7] / dtlbs))

    itlb = x[8]
    if itlb == 0:
        itlb = 0
    result.append(x[9] / itlb)
    result.append(1 - (x[9] / itlb))

    stlb = x[10]
    if stlb == 0:
        stlb = 1
    result.append(x[11] / stlb)
    result.append(1 - (x[11] / stlb))

    dl1 = x[12] + x[14]
    if dl1 == 0:
        dl1 = 1
    result.append(x[12] / dl1)
    result.append(x[13] / dl1)
    result.append(1 - (x[13] / dl1))
    result.append(x[14] / dl1)

    il1 = x[15] + x[17]
    if il1 == 0:
        il1 = 1
    result.append(x[15] / il1)
    result.append(x[16] / il1)
    result.append(1 - (x[16] / il1))
    result.append(x[17] / il1)

    l2 = x[18] + x[20]
    if l2 == 0:
        l2 = 1
    result.append(x[18] / l2)
    result.append(x[19] / l2)
    result.append(1 - (x[19] / l2))
    result.append(x[20] / l2)

    l3 = x[21] + x[23]
    if l3 == 0:
        l3 = 1
    result.append(x[21] / l3)
    result.append(x[22] / l3)
    result.append(1 - (x[22] / l3))
    result.append(x[23] / l3)

    inst_mix = x[30]
    if inst_mix == 0:
        inst_mix = 1
    result.append(x[24] / inst_mix)
    result.append(x[25] / inst_mix)
    result.append(x[26] / inst_mix)
    result.append(x[27] / inst_mix)
    result.append(x[28] / inst_mix)
    result.append(x[29] / inst_mix)

    return result

def removeconstantrows_apply(stats):

    result = []
    for stat in stats_to_keep:
        result.append(stats[int(stat)])
    return result

if __name__ == '__main__':

    #if this fails try to change the os.popen paramater for this scripts location in demo.py, called path
    '''
    arg[0] is the script name
    arg[1] is the core number stats are from
    arg[2] is the stats json format
    '''
    core = int(sys.argv[1])

    x1 = json.loads(sys.argv[2])


    x1 = formatRawData(x1)

    # f = open("/home/tugberk/statdeepnet.txt", "a")

    x1 = removeconstantrows_apply(x1)

    # if core == 0:
    #     f.write("Big to small  ")
    #     for stat in x1:
    #         f.write(str(stat) + " ")
    # else:
    #     f.write("small to big  ")
    #     for stat in x1:
    #         f.write(str(stat) + " ")


    x1 = np.array(x1)

    if type(x1[0]) is not list:
        Q = 1
    else:
        Q = x1.shape[1]

    x1 = np.transpose(x1.reshape(Q,x1.shape[0]))

    xp1 = mapminmax_apply(x1, x1_step1[core])

    xp1 = np.array(xp1)

    a1 = tansig_apply(np.matlib.repmat(b1[core], 1, Q) + np.dot(IW1_1[core], xp1))

    a1 = np.array(a1)

    a2 = tansig_apply(np.matlib.repmat(b2[core], 1, Q) + np.dot(LW2_1[core], a1))

    a2 = np.array(a2)

    a3 = tansig_apply(np.matlib.repmat(b3[core], 1, Q) + np.dot(LW3_2[core], a2))

    a3 = np.array(a3)

    a4 = tansig_apply(np.matlib.repmat(b4[core], 1, Q) + np.dot(LW4_3[core], a3))

    a4 = np.array(a4)

    a5 = np.matlib.repmat(b5[core], 1, Q) + np.dot(LW5_4[core], a4)

    a5 = np.array(a5)

    y1 = mapminmax_reverse(a5, y1_step1[core])

    y1 = np.transpose(y1)

    y1 = y1.tolist()

    y1 = json.dumps(y1, separators=(',', ':'))

    if '.' in y1 or ',' in y1:
        y1 = y1[2:-3]
    else:
        y1 = 0
    # f.write(" prediction = " + str(y1) +"\n")
    print y1
