#!/usr/bin/env python
import sys
import numpy as np
import json
import numpy.matlib as matlab

stats_to_keep = [0, 1, 2, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]

x1_step1 = [
        {"xoffset":[[0.001],[55],[0],[0],[0],[0],[140],[0],[0],[0],[0],[0],[72],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[58],[0],[0],[122],[72],[0],[320]],
        "gain":[[0.672043010752688],[7.57782999744627e-07],[2.94776559367999e-05],[3.7597871960447e-06],[6.80399394444539e-06],[8.40336134453782e-06],[5.71898672137068e-07],[4.53774038679699e-06],[7.57767208609145e-07],[0.0032258064516129],[4.53773009127644e-06],[4.94045516413427e-06],[7.57787880774202e-07],[7.52635163867491e-06],[2.09404568579473e-06],[7.57767208609145e-07],[0.000101890060624586],[7.52199242535363e-06],[1.5933461863259e-05],[7.77372248588098e-06],[1.5933461863259e-05],[3.08646738375592e-05],[1.49724133284423e-05],[7.57783861098218e-07],[1.09549603238724e-06],[1.09383878894545e-06],[5.25184293733475e-07],[7.57787880774202e-07],[2.09404568579473e-06],[2.51031677436344e-07]],
        "ymin":-1},
            {
                "xoffset": [[0.001],[1],[0],[4],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[1],[0],[0],[4],[0],[0],[10]],
                "gain": [[0.916590284142988],[1.09686767498056e-06],[2.41312741312741e-05],[7.74297354187226e-07],[6.7469326757323e-06],[1.08372360929813e-06],[0.00598802395209581],[6.7469326757323e-06],[8.95559814440006e-06],[1.04758278130086e-06],[1.40050137949386e-05],[2.350593348526e-06],[1.08372360929813e-06],[0.00018756447528838],[1.39941364568246e-05],[3.12724770929105e-05],[1.17003539357066e-05],[3.12724770929105e-05],[5.36970412930248e-05],[2.08572322452811e-05],[1.09073437509374e-06],[2.08469707266837e-06],[2.08469707266837e-06],[7.12419937356915e-07],[1.04758278130086e-06],[2.35080332826735e-06],[3.42292672900159e-07]],
                "ymin":-1
            }]
b1 = [[[-1.6170983119680319984],[-1.5701678225094688468],[1.4694781041246800513],[-1.2364704794533918353],[-1.2660582073858959173],[0.94728675900055803183],[1.1028389393087034698],[-0.68812591145072476984],[-0.67179580522168169665],[-0.50257621318016920675],[0.61348346384337715254],[-0.45396012706803307024],[-0.22762405376412711555],[-0.077505008438596201259],[-0.4305336317095268539],[0.0072064422503855252167],[0.069323939717359839285],[0.062243934282942364744],[0.40265082014902364715],[0.58332026282750293333],[0.62263930564913738674],[-0.6303523555659763522],[0.73579977804073293246],[0.91108116856432375119],[1.0242860965609441593],[0.96150268163710894687],[1.2698450485797165843],[-1.3641319802260198912],[1.4244203596538813628],[-2.087119347700490124]], [[1.4870151370335988883],[-1.4698904908929784074],[-1.4263908105286893235],[1.6103072323213309947],[0.8436290677424209683],[1.1709423905632865281],[0.95721760209607154035],[-0.73879579964384323176],[-0.81574976482949612677],[-0.57965486028596291401],[0.74680367776615685926],[0.47528278478489027759],[-0.31643713893398739412],[0.021095528835162743325],[-0.22886741624830606034],[-0.028665628776603935962],[0.17095667772863454292],[0.26769641004975791576],[-0.41841531455394614936],[-0.42974914715552614553],[-0.49373151527329578458],[-0.94459785054313294417],[-0.88444922836611716832],[0.67926473868632364361],[1.2935717383031222205],[1.13230031941875664],[-1.4951917487726122946],[1.3666782774933476929],[1.7623846318659139865],[-1.5823426583264255108]]]
IW1_1 = [[[0.53598612813643298214,0.5465712360594270347,0.42346516929960120734,-0.36845943067780001501,-0.16691336312850532653,-0.27098830261435458144,-0.0066811431137469776131,-0.1648899303099493896,-0.2934481995470263338,-0.12312856132729024794,-0.29984621390500831861,-0.38358286247562278781,-0.42851847416572341753,0.58611299109361159054,0.082984699739190800893,0.46467652715499113691,0.3635167457692066173,0.26919504528291721135,-0.47845021202082693712,-0.37300316428742924524,-0.01927138720099290381,0.73963276465510374713,-0.95656397182960184455,-0.15564099244241969,-0.32779440067870130315,0.19294570302909094806,-0.34196912842911236785,0.21632093506039642983,-0.52956925738160165462,-0.57198655487369920447],[0.20857131765076467045,-0.27532134620180526152,-0.057811772759294159651,-0.21975887386910258892,0.69433710216329402876,-0.31003812648197254243,-0.21144471197948008778,-0.54524641640326343417,-0.12499301205572879714,0.2333099130637717733,-0.1912650061927185785,-0.13941048149590057337,0.11724359141572103515,0.53683472890142436285,-0.30747513597971343202,-0.36798539533239010835,0.32371015928382573801,0.32422524807094654786,-0.013861934984269321663,0.3420515592322856957,0.36788932123719692013,0.30219725941693120763,0.21327123838972122938,-0.32679347113348378162,-0.57377301144434811331,-0.88896927837368688863,0.48533314460899895648,-0.1852369533209756447,0.032281623360511851883,-0.52197623855872732346],[-0.19937536892749710415,-0.18015773349359950894,-0.12798479415456318065,0.093875672310580610125,-0.20462128772040877323,0.20700767619284812793,0.13246097777003362772,-0.17580336320776007719,0.058663259666461582686,-0.13793630054351857517,-0.56978783354261508531,-0.51269482164047985862,0.18168197056446588888,0.18798147246231208807,-0.25876498552038668111,-0.25262004003998039803,0.29929738805416183922,-0.042264130388171200492,0.486393473666370868,-0.16217389524340905527,0.802229122544202089,0.9481500392522629328,0.19149199963133053948,0.53252348352138634269,-0.16483904830117035445,-0.16697957094693460789,-0.096931445157047005368,0.04705967230137494961,-0.072944482162325033348,-0.073239300124660178248],[0.38508927484798333163,-0.44143993960282107425,0.15182798700423844052,0.21001242402088016181,0.19666736349390334659,0.37582893685046242505,-0.29970210102383398887,-0.30127653038418167331,-0.47541846455486280743,0.14691516410965563266,-0.44953062587000108818,0.43540366046764006347,0.1738215282786751692,-0.16807897174260125195,-0.29997613735504330412,-0.10746253241424424951,0.34631457860354208922,0.25603912366423603464,-0.2412355463277039147,0.082308170685490733565,0.1634044589189745933,0.04462212567020169135,0.31915664769348001117,-0.22556956183711077135,0.098711463232792562295,-0.20840802763383642349,-0.45704084744206713298,0.45460006327169377727,0.013873893309171179966,0.1148154958664854286],[-0.053637095021705848141,-0.48788891844228832184,0.17239555491953148514,0.3295445331165802183,0.79042066156566326285,-0.81971685580772857271,0.12187923570932249206,0.55165668209324991711,0.26875280431374748424,-0.3245765857631505158,0.23203477942947639545,-0.11081428194282108568,-0.39969236981461325753,-0.13542588374785929917,-0.29840485749087508616,-0.19341841625628564127,0.31226982026448057983,-0.17155556483847081428,-0.0090341617572919259704,0.0065316842921141413103,0.5226686067346228981,-0.89588075800163791129,-0.84991623245696257261,0.12650884063535580704,0.42133535249175557702,-0.80756827883444914917,0.35357168506780550787,0.26797995232741450566,0.50452851210104598945,0.24035312858010088322],[-0.28087984112389996483,0.42225517068591134073,0.67410000189155749872,-0.26711800479838365696,0.7930153866415300401,-0.45525252826456885646,-0.1534336326559833652,-0.023592330218886466142,0.15676714521850509954,0.14141604315752093202,-0.11043261345009719454,-0.20195511442797781099,-0.022771558645606912452,-0.33022303942560399248,0.018478369974152964589,0.19187967773141292871,0.04984532034960904856,0.51010727602083660859,-0.062048800578414844975,0.18703248341116845976,-0.008744691408874669114,-0.42308806177885766031,-0.074465447865361467095,-0.061179539126750635825,-0.17325021565135756418,-0.71168150302965138554,-0.59251451989661896302,-0.27330619985718224152,0.15210221471515597558,-0.20954437896040273293],[-0.49815039924275333894,0.095508790584759944986,-0.27786978935403600088,0.12882104442328026761,-0.55346618689818083414,-0.05291704724578123048,-0.26230528600171676423,-0.38172824045318975994,0.18954755447218371578,0.64682814093155516222,0.35027040530256225992,-0.15542418553910822276,-0.24245384184648355319,-0.24647995311635872984,0.077621364544359458537,-0.015662688767326089084,-0.41734302261024663894,-0.49486672218608135365,-0.13540131225847357177,0.3307500226597173687,0.65045905540392101596,0.41643919105710058837,-0.049560384931328423097,-0.23587318916612726172,-0.23482601441414077681,-0.5234460537774658917,-0.1246719244017141931,-0.35894006495822183833,0.39237374224379945042,-0.61950985238290356971],[-0.27501476118224665868,-0.26419314600363319467,-0.23484185387307349169,-0.31649503451780430785,-0.91818473997826710598,0.78613178284219042968,0.27764989938202000452,0.14728977029092116258,0.196005441022494592,-0.1875870799725452287,0.8220701630366945567,-0.15743511302222176762,0.67000043405896303472,-0.1838577710966306511,0.089389473845176398159,0.41107932754670656328,0.2560817419938581363,-0.34245966519547010876,-0.11179855332996142814,-0.5480569596836875057,0.45819061620663859014,-0.24299270762861710504,0.34824793563474287783,-0.53500572736374329974,1.2213551589728495195,-1.2421231067267946013,0.52052729117464024977,0.029834529124869713784,0.32881696202791960149,0.19471658132657196361],[0.68034895901595959788,0.30518767925251000239,-0.41984906549362566164,-0.53455529297928650045,-0.23497912006757712411,-0.27012224059657413688,0.29284193192737134614,-0.16565045208363160523,-0.27458820129963190659,0.043050447530300475774,0.30721069529851868785,0.13496187385153146643,-0.30405753331055263011,-0.18754977335065961541,-0.020088908325084448014,-0.050804789023429608452,0.20947070133743034281,-0.22696829277126207014,0.23590373847348677927,0.34165742118911912595,-0.42115657530010991438,0.47914620473337382611,-0.33940293699521134618,-0.49682914363869512542,0.61260231354070637799,-0.31666087033081602442,-0.1388887338013737871,0.20110671073010502607,-0.041222964283456453582,-0.19582468412806841584],[0.43821217118560579218,-0.39666810078712477772,-0.16837047063853230466,-0.25265471757240792749,0.13330416897615979255,-0.41706292171236436506,-0.46534980321181806939,0.018567937972164043348,-0.043451487432027841029,-0.33777760218222641075,-0.23948093769394918073,-0.12900581148838183299,0.24319648121279441311,-0.46508411378930303304,0.22553540403661564984,-0.42546782870461502535,-0.2022356464192785197,-0.57382966750454089677,-0.29430777835094856787,0.36194061652203934898,0.16276381970297731927,-0.40549701443809121892,-0.34399088662325244536,0.35062323498433894953,0.0021179933131966728957,0.18844156673099540789,-0.2903397723368932315,0.010478138686929148668,0.027014720800240161341,-0.27161726171713551636],[-0.60214514474753944029,-0.17092808329677652845,0.079396713331903429056,-0.3598256089775609956,-0.004447446907656443793,0.17901373739599940604,0.29731299849702591542,-0.306172099961646349,0.082068691980004770947,-0.12031708400663818082,0.052978869090316904611,0.48011061359323464748,-0.042909225938158490621,0.20351973303964523976,0.007191983664722465322,-0.72764262361104048438,-0.083911077025146246777,0.19075705648832469441,0.13163600194735131099,-0.3592131995522503396,0.0043251656868994788757,0.37085950204408885122,0.67003629784406759651,0.19405472837532020125,0.97521634745344376594,0.45035500150304885736,-0.42130943625460137714,0.10721524737018295337,-0.40775111654785534121,-0.36833650201608908459],[0.43097609881808857102,-0.021626688697916243709,-0.1627056570891839693,0.29722092434962082974,0.41655724567646584822,-0.090884505516061128705,0.209392767816985792,0.43072593799988817542,0.10631086747476101162,0.26787930179942448516,0.057107838400247801225,0.42883582939050596261,-0.15693701569637200088,-0.30735835925592946971,0.3702298106167268843,0.26777271275981828769,0.17501558788772988984,0.01579823154808306096,-0.041572166462900919659,0.39688740154427509799,0.50777174955702730763,0.1503696750636209778,-0.33483739607905937952,0.41179624249837887273,-0.29549698411486113869,-0.30317242834773394655,-0.0089312649892521397965,-0.1646574249570629811,0.36111910520440826389,-0.33969144174384824364],[-0.58318164744105693842,0.63079196848365060024,0.41296546330912398126,-0.71418099510442545341,-1.2718143282009821693,-0.26004468309660322412,0.27105450595010854853,-0.034921843509803138228,-0.048125690066096626918,0.51086197893613005672,0.52110905566461573901,-0.41524844157102852593,0.05311312783148418315,0.16408007115462089343,0.15798425689529840832,-0.096871611410709268508,0.25225499654734845345,-0.072677126575171627221,0.31936943432365372253,0.0070150133376981295072,0.16005126481612783063,-0.28900153445925924611,-0.3942055917549273647,0.50037478492388254292,-0.8431866872457982609,0.19747803950728881617,0.07252088027436519313,0.071573966559841259438,-0.299295357158198716,-0.22888235472496237799],[-0.12518702803770029308,0.25110811617928097128,-0.85156374074878027347,0.23901681398366478315,-0.49656520451924007764,0.61175220263003116106,0.0098542946261847980116,-0.30769781782439870055,-0.35809100881525118831,0.30136415697043950068,0.24312109969861728231,0.36210169539667680372,0.081338757716037463075,0.01591904145937264245,0.42210750921865108909,-0.45166630572849753023,-0.46952588011999052409,0.32390563054088394868,0.23208505888891967084,-0.25903911238056670507,-0.034290691605633416561,-0.23859330148144705652,-0.1748933176215136942,-0.36343670848447645616,-0.22974710498115180624,0.525652263664031838,0.84197306273054151049,-0.32351712236486634966,-0.40114893832031023324,-0.43029052295876152323],[-0.1792390774234600137,0.28989032997456426477,0.18882425823131859799,-0.64726045600278470094,-0.84644697438201710327,-0.49738134309698311952,0.037677155853868049551,0.38367527368959619682,0.054082438769358934239,0.24963107978825105349,0.27603290696582460928,-0.32386911445153981903,0.023382163270114348502,0.16605368434475314965,-0.0050497981965260223258,-0.096987433943371212375,0.52683612776770805119,0.095594589338819965785,0.01794403763671623131,-0.65997959126646521533,0.38499625980087953669,-0.18080075596240813285,0.53658691122880797231,-0.18844152551789328243,-0.3437125935327113857,0.28112516994854785946,-0.26414760073246978944,0.31967872404065689196,0.55858945176855778758,-0.68903260680241917857],[-0.48259211334467799759,-0.16502872129871343221,-0.26165174801637081092,-0.025608602695478700079,-0.52870848621784627408,-0.53608299131531056414,-0.12747013027045731026,0.47230337941631411747,0.034011728325811521612,0.059984817398446729775,-0.097107703251383903353,-0.10764274383545782698,-0.42990390515589771425,0.10401474376339342465,0.53832315753372772527,0.015963202130062140865,-0.11177166747102271205,0.18506784895095362842,-0.46036628661169598509,-0.18241890056089923866,-0.23489029473150233041,-0.47053697551245499131,-0.017865267308915581262,-0.51334451013214432713,-0.58361226866584059447,-0.10938613657581262861,-0.35086172158739076243,-0.33714180752967115584,0.33423222074463493358,-0.1977914669507745693],[-0.37524692749073901288,-0.41667415043809763464,-0.56276772483095016675,-0.48932160592840656665,0.067326215147533577388,0.56712656840454211959,-0.096049572126707657982,0.12409275033799677113,0.04601617537815624881,0.16294624263978615963,0.11653229581833798867,0.078299450208896892445,0.038927502380757074418,0.13760798090317585829,-0.47638652999923625231,-0.54924037475151976651,1.1004860431529692733,0.56445950014823909058,0.24232303723297574094,0.75965668573102385075,0.44657119735972089503,0.40071791339116308306,-0.21528097247193681008,-0.017363795084706295374,0.28311029899200840232,-1.2852103553784930412,0.024484354562481554229,-0.20827004269551208093,0.1049356025986065144,-0.187362401328364514],[0.45348816069397229755,0.08322336202313709852,-0.19193090462268611041,0.15233022689110833903,-0.60042247305170903804,1.2794268682265284021,0.060733841830012375018,-0.60672791072881160357,-0.18809490181744037418,0.31413774350608419939,0.063655874684797233987,0.45887660472975877468,-0.14848550518858844027,-0.29398878503122627404,0.067591676881062712212,0.13393740769477954777,0.29160819699543316652,0.57108591433650834901,-0.20740032183114015529,0.25086695947509740634,0.2401267647999471011,-0.52843985086568601162,-0.6512280528172370575,-0.2009412827957700598,-0.046717867483627148473,0.31245596632593158892,-0.09033682792367346559,0.15683311978372277418,-0.18975359535252936394,-0.19721158488082912719],[0.55299560999009245155,0.26936435839718553265,0.38033850039670835663,0.10775416217084368697,-0.085276319622016122368,0.04722692594610286565,0.044871894241496047828,-0.36913926118586043446,0.0067167206032284175465,0.26043001526312437033,-0.55160245357865766991,-0.24481980513511264475,-0.59322228143073540974,-0.51260708474290450631,0.45679231005959292089,-0.12345041041123691605,-0.46253991825163454088,-0.39742179771200869531,-0.16400232531252051382,0.26161686633110492473,0.15402171098390288195,0.023552401541275538865,0.64326961015402617239,0.53581476161047292273,0.17826570487635115536,0.13548910181960863164,-0.060029493864836622197,-0.75590023360630886895,0.01558294019281910095,0.36184901672637942438],[0.011628666216087237689,-0.027587940630103557904,0.29901662769133213748,0.30342668812596762518,-0.2056480142387895893,-0.3580944128603219534,0.2769513298846542626,0.36723745437758692489,0.45131670040113286424,0.070083038217016085936,0.11933391211440544377,0.78048823833342184653,0.022612901199999445312,-0.68532445103471528736,-0.2124602302802816034,0.38780308256601098149,-0.020928455937123575242,-0.84970836613450262398,0.10359158513805145907,0.27256371465752188277,0.68701121631627037889,0.09674467840631728599,-0.56852192709834170614,-0.53211467437797033142,-0.91943022351126313385,-0.092560727540047349482,0.071051670428012678182,0.0745033307994656252,-0.24079336746827434412,-0.093268333761035507323],[0.1313819076008407305,-0.165627546822652294,0.12885886161356280288,0.20037415475955541733,0.83868543098884817955,-0.26543932472425874058,0.19017906843769002978,0.16172562437498258503,-0.60592371672499245605,-0.31171207664726507947,-0.3214011629023185157,-0.20723298484599422808,-0.2612554093275508138,0.22760322349802378228,-0.25777209056737110382,-0.34072300004372824134,0.11582451983515074101,0.4207472507296473041,-0.06718463418606514248,-0.1917335728434179376,-0.16243300544226141335,-0.89758981587936836899,0.36086416460216391711,0.68086630096940314871,1.0311227918918306479,-0.20992663350424747848,0.040956556581511829873,0.0061141578401528581463,0.21777248278039831875,0.072639016698705025088],[-0.79890871611528690988,0.42666619548948775398,0.51957087919409450372,-0.42284115536666982971,0.075393366406997910922,-0.11941823139134039033,-0.3155996970634197818,-0.22701500397958973565,0.27395977540087468327,-0.38937369646747305163,-0.10048559228562740919,0.21916145292210165163,-0.41775161125328397205,0.21427350159539804153,-0.41240394164421523282,0.15625392490608086549,0.075278482947531838443,-0.32928100115682312765,-0.13132948239626773823,-0.18781822253842125892,0.022177207661791938087,-0.40948639027402022883,-0.39874153831982367402,0.3398499529782270101,-0.93696943531739773636,-0.80303751124413980111,-0.46283672629451455549,-0.55285196058004471009,-0.21076540197609519578,-0.48544441690864897909],[0.41701889213063586537,0.1464659106678159739,0.338137755163862741,-0.40408511799154439581,-0.025131383109499437489,-0.12546722249527403337,0.44960876096642515831,0.02649405158307830202,0.56789803057500787276,0.47583223761678933306,0.25621254645747537637,0.044601497552342321551,0.26778405842945357529,-0.061004212448425451654,0.26115460412165319992,-0.16041912976968222826,0.2484802168716929438,0.042743520403252813211,-0.1219687343509028854,-0.36464107290668701378,-0.76627154920631013191,-0.38042518574939837572,0.66657631304007058937,0.32331877443763862301,-0.28216021132937590954,-0.56426795129714069077,0.21686916472308165327,0.43301430138540353276,0.045529797906639288274,-0.27852976343546637095],[0.69225060712278896347,-0.21748627168104980867,-0.17233182921768663842,0.49394609204745132391,-0.12501146492369399899,-0.02457229933184244125,-0.031117049313776609654,0.32172705094565012818,0.17772471941866982426,-0.26386644778818718615,0.40688205301017721371,0.32983293024042786845,-0.35249141208937490033,0.25387471071144407375,0.46979850626407532177,-0.29109481601116637961,-0.66112949785998742502,-0.046438501066285893526,0.0062923366988517966808,-0.54524192502598445298,0.25995527842257809548,0.9207415502576110633,0.17613777567086821851,0.81505798254984884732,-0.019714953322187429852,-0.15157665969897571312,-0.81432217185658029024,-0.50462450321313689905,0.25528996202408238414,-0.50279660328004238679],[0.16340604694772475902,-0.3623200827128255086,0.38446391438707033794,-0.32642502710028320489,-0.093916387801817227676,-0.42949608738988065415,-0.14187179033273025763,-0.26274998130837640131,-0.37987716675585042614,-0.0085294970698327442216,-0.41216615397614897454,0.17949680284085733906,0.28852606585054701993,0.20369998842498862612,-0.12375290928792329059,-0.38691705575543294815,-0.17654994257044340222,0.33516202365893482673,0.25529906205842078926,0.15959584472896087837,-0.37990132033364082398,-0.20117090358308586939,0.44086824751375097708,-0.20678568606455757783,-0.040062241918483079695,0.11055820467502917859,-0.33878925673406623531,-0.2027246436072666913,-0.38782747767732972388,0.390264152722985036],[0.15385767624172289048,0.17675360320378316614,0.097274179110951958238,0.22887250590501476144,-0.87538434945171728074,-0.043533539748876706743,0.58256501942672078709,-0.30884912633294464568,-0.34521335565192162731,-0.25720228085587570899,-0.017643679770615795788,0.38196739310354554942,0.53983465053257218003,0.15087677496882595518,0.66612070041314164204,-0.020292189862944561701,-0.44317527328819356081,-0.36541810061820856337,-0.30881752750436725075,0.16156161229265617041,-0.07193374560454694755,-0.0067896839974293660136,0.36797075614022611845,0.01446023441183257735,-0.6463188831657654676,-0.87886811753215399179,0.31327386814351909639,-0.22995323849146864781,0.1867419999971556277,0.021096886733184602031],[0.34648216304352219552,0.60372657524084583081,0.16652463328809505305,0.015431571310735792829,-0.33021544280703141183,0.15291912621934988792,0.55762357231474957153,-0.26458083322976128082,-0.15263004643277022776,0.38727026549444537595,-0.0063330524119982693071,-0.39393262044737487049,0.4224514154335256011,0.013902668593834269922,0.23751708455583731006,0.23804128378189082227,0.61063356440257909874,-0.13031804770587593345,0.34900487058902324167,-0.3766842402880376528,0.18334358638786027451,0.41615393915290660454,0.26444201155522589763,0.076239781269261022723,0.26654044380507907475,0.28496164518922340037,-0.10327297036219333648,0.19824632209898329638,0.34699941632232339517,0.1887478230893540887],[-0.14327727148654462175,-0.16699092269839710401,0.35831654242431648649,0.6180705874467501415,-0.37221438658484251594,0.24492408726664030572,0.063511384925197617024,-0.12367572216772765303,0.18353751527351566675,0.39938665936790224142,-0.0069325070055626467763,-0.38153723618675650098,-0.19095050696729845563,-0.18372917471217040108,-0.55645342907986128367,0.025229939211313202885,0.27180871040962073515,0.2344016632928360433,0.26928384580892211764,0.074775308440156409984,0.23917018030647752003,0.019052777084016557507,0.078572858643517179411,0.36519091569629552607,-0.35400890997811024219,0.25929830565813261067,0.12082021175081227027,-0.49119337318788064417,0.26344547981677790549,-0.23713603286039486306],[0.046300824652489622202,0.09073621285291148808,-0.12141217062242017077,-0.41830909338215072069,-0.29622745499236241562,0.1931095454741491857,0.20433309662765089532,-0.010932108095750268234,-0.41766833437519451655,0.05504842751539658352,0.24240659861779542683,0.59885669076210246153,0.18316308617743601306,-0.42237137820513409592,0.12157776419114603439,-0.10286883025733561947,0.044342048855619542458,0.2718995601562608222,-0.06608434608131295851,-0.24723581089739696259,0.492760645448482415,0.088766981991973359367,-0.32139760918459991945,0.34937738979583404797,-0.57110331042836415261,0.32741912995206617909,0.26031175110331905564,-0.011331568349405518603,-0.39768203342974023373,-0.38610147204227523998],[-0.24615355737189542618,0.016997921449384820192,0.11546870693717192768,0.0010351899746206759921,-0.24689729726132897403,0.019845541060937450795,-0.001963264194965037325,-0.090612037011988888491,0.36468505099615922127,0.023431509304222369189,0.051311728849405741082,-0.33322688755664242599,-0.62896506921208350516,0.074964120271614989588,-0.015582173264444658389,0.27354499348209865284,0.2352309933378989304,-0.065764653965225308707,-0.34781172676757188267,-0.67094235470917185093,0.56173379735295814186,-0.070478473263264493354,-0.27075066275723513876,-0.1235373837782433315,-0.40883329865427797678,-0.040337141317692636056,-0.22716235532831516308,-0.63371393862133473807,-0.31736331265370282262,-0.30008683089051069182]]
    , [[-0.3760067258944113644,-0.016673729497458822379,-0.45040886333979923695,-0.12534506885822319089,0.320442841177179083,-0.14906540365138973292,-0.2589182405936861775,-0.011334055572364012954,0.099251822955707780238,-0.086064488936550137543,0.18688523185672586968,-0.4382020300679633773,-0.074018986915430504125,-0.2083367165576524016,0.052799390876270502204,0.53686699266142801079,-0.36786258599996735086,-0.33829997629309910279,-0.2408943494660840956,0.3662368474825905551,-0.31163097954794177769,0.017418275789912514295,0.59384490862422867341,-0.42652259839247830264,0.3021246068988495681,-0.48720512682851591091,0.12488091319896109377],[0.15398426016792884918,-0.1346128309319657157,-0.50149249137085882833,-0.25889001988943843857,0.31781023012485304369,-0.23385724194880117,0.18410295525741635081,0.36189480474731394732,0.18634443827466687371,0.1099504565987093202,0.22400983370536609041,0.43175896765319793369,-0.28003409409560958698,0.69860227294294652278,0.39185918365204230884,-0.33302946760184554131,-0.45764891942714158724,-0.14382321166576148008,0.30763110297018514405,0.13190379934746096491,0.24054291924705040184,-0.06145202142711708726,-0.19556238690785918144,-0.17840492150676520722,0.037530872443471620381,-0.21399905663318732896,0.52507941330280583081],[0.48479365347459274505,-0.41258291099376454003,-0.051440074977853772475,-0.0061194718812232979169,0.37725624458089623836,0.048639558179025203788,0.37766324806444556694,-0.15331215593633321093,0.44284316792370564952,0.16401109838100552674,0.25930990806800963133,0.27621577162315269494,-0.15476222799433311805,0.21586692396395892879,0.25982502280865127364,0.57972850828472977103,-0.22211489788703872583,-0.10365648873856628254,-0.30734779333124084832,-0.32514418406779366233,-0.099626723326218788457,0.5218753626868763984,-0.079571965726986493284,0.072273510039092977997,0.35119179885905449368,0.37478847080946914305,-0.46452024765875299384],[0.087057498253409582034,0.041800471227721860967,-0.26716829732221913929,0.60552967313376071523,0.024557364435265502389,-0.082277541230466377797,-0.45718129225795539616,-0.15403729826583750784,0.44474488689369762184,0.023404877308959078086,0.62371909345186349327,-0.24530976697519762952,0.34301951421954157695,0.85047211313236181773,0.49875962341192570104,-0.049055889224145207694,0.05531922453133002876,-0.66283098417028007976,-0.15926700212080016628,0.29973646101993367541,-0.91885169981677261575,0.33524883528208038186,-0.81676615726775392279,0.59102910628420612937,0.73587963965622571472,-0.73859073000300834444,0.13549866801413312789],[-0.2148003363524433329,-0.12147205442238050155,-0.4563659541957719723,0.067153039658596591632,0.54463595381110296856,0.060955376416806553164,0.31259820223326806321,-0.38843946097658776928,0.25091219858693025735,0.491740126374167974,0.079538507279187764532,0.049463929818075125233,-0.18582368807081836581,-0.17911644053706438084,0.35529640104716792015,-0.5255797546167001455,0.16484903298275291328,0.16079894294564781032,-0.4720505156626694232,0.50373289234772766765,-0.11345540588556699002,1.1267173287104388368,0.68092464712166245189,-0.14317510881306697024,-0.25300855765139890208,-0.43349253001710924549,-0.48152373849519297666],[-0.36082163296569785826,0.23933166902743582827,-0.27676600090319847247,-0.21657745631611172166,0.045335371071329802484,-0.36398071012989757778,-0.48168402002980648113,0.015908141329901582389,0.0084274892668169069238,-0.45842923626359727285,-0.21730198165967659629,0.50886235921853284481,-0.45217689794357435185,0.33172932418297135237,0.027884455612866745899,-0.46372233129397927298,-0.37163467629434276951,0.15367159415424122559,-0.20739173343322303555,-0.18360731008463718195,0.065144275459994752109,-0.41030515068437484194,-3.7223309081833361915e-05,0.26007759456592216551,0.3597402460924924994,0.068057073802330475543,-0.19812654915620897533],[-0.63251984429110874597,-0.24902461321156144081,-0.40168493427197504708,0.14552912378932067461,-0.36766678936860119897,0.29655396656042531944,-0.061354944684851378534,0.26185957268045562119,0.32608102238911196302,-0.038064780011805743332,0.24109967326956241451,-0.050048349153832043246,-0.52429333128462274338,-0.25429659464262655,-0.27354183958598971005,0.33961553938150024212,-0.39501289702638048285,-0.094165093768531826779,-0.19093669809698232687,0.059909913045112242469,0.38873518738831147612,0.33472679052513631959,-0.19892103938215988101,-0.49688117470134191,-0.43900501493248345053,-0.21654994192621299098,-0.075969535965131007593],[0.62429765207897880419,0.29087015885560946193,0.33427561950267387081,-0.11614428412476507368,-0.42773072005700712994,-0.1550684950952046226,0.032051504350971149471,-0.32773000188458245585,0.52123681866650850569,0.067293989167271847651,0.38694574391659491974,0.17578345440591683357,-0.12727838193889434715,-0.45500376541476988956,-0.56908361668919049681,0.73841671421108112661,0.13670632326349482777,-0.091008697798192317308,-0.19302264084111359077,0.2546873668462623086,-0.23268739512452968343,0.60786843697605075221,-0.27631334603490415036,-0.62943431040611441674,0.39083800227452536458,0.049737313131818450263,-0.00032870745121855874174],[0.38531330813167852245,0.058601009548040851327,0.35629270584042388448,-0.30098702892341033799,0.34880499173509149635,-0.39504990590164829056,0.47958074663749833411,-0.1218090431937392526,0.5723384837473456388,0.20290475776016725362,0.46767314382708297105,-0.22944169325648200441,0.39861963509303438569,0.073012851202367376469,-0.10245928330223072478,-0.025119789862858201562,0.020167352191469093553,0.44123613957359358873,0.05920971069270260928,-0.40575007369994353645,0.013810484960636675716,-0.16135662057301755623,-0.20539447835394097908,-0.15696667022393551161,-0.0059954999445419841775,0.38233734761225024457,0.34241926858818078072],[0.10958012832666065572,0.48875943480098893446,0.045544319947243228075,-0.13485016039301606083,-0.16743676234312979134,-0.17142971965876796503,-0.11042177653894783007,0.46917094622135235849,-0.53408652853318783205,0.36041561281814304962,0.29593156447644691776,0.38187844435249007624,0.43768778644961403579,0.010580073662250279523,-0.47335135521500842914,0.31084433162747066026,-0.014541286705633350851,0.11598665062760324385,0.16337405790554521134,0.3909869878247556052,0.12179068338644927216,0.31777107690254507988,0.27009401495783269542,0.29045946734005634315,-0.30586874544479791815,-0.033912646127456654022,0.38575899744485708798],[-0.16212041728356635373,0.42408541466400306863,0.040165647410835954301,-0.36380821208207958506,-0.22179702725890249049,0.060726401999103910012,-0.18129178024245798384,-0.45546711444812559844,0.1176764898595136638,-0.25210550953552840481,0.34389878487105485227,0.72018131888587477718,-0.41791810120531946993,0.32890532585423271073,0.33260570951114909466,-0.19571835057191369622,0.22274911525067433993,0.28696057914997019633,0.39283332444007024176,0.28481329750381612076,-0.32981692810954493789,0.2630555176385662719,0.28846517599415960609,0.96366574454695874685,-0.5641730228447332518,0.35570065383962273797,0.25121098579360939818],[-0.23767122366421608581,0.30646015836151185852,-0.2135979185678565373,-0.47821988832026085525,0.13054459220532282915,-0.10481001236997290749,-0.24162090120600127063,0.16576132929009840256,0.26505312162135569176,0.59996252248051884504,0.061785122621366053708,-0.60715289849277576106,-0.52714238883732644769,0.31869589640353063187,0.4767063210333272183,-0.30734687703942881187,0.056000465121272033353,0.22486208293769566202,0.14921675469165945893,-0.15178484617302029358,-0.59446901995308676359,0.2945894714586489993,-0.45739579687051690193,0.065123424148040398585,0.23861031962311471388,-0.31184970525857930168,0.065700320161168640487],[0.34963453663861721044,-0.35177844387777068569,0.43654850501277453478,-0.72655158119482399215,-0.075286862674535964812,-0.066099850451926872585,0.12402172503128991443,-0.50708655296715599015,-0.26211419609330677272,-0.18152842112909434169,-0.056861589914641963439,-0.59519473475077711022,0.49035350461313526038,0.072018912185743272358,0.08658936984466984732,0.20401058566433821762,0.69068160182823767901,-0.078145842454816982769,-0.1475078269303418399,0.19046212354252373133,0.14030882219730106408,0.56503559645050593918,-0.35810066466621293113,1.1530482964868775664,-0.30011040611853379012,-0.72708799689861125515,0.5132970219903710829],[-0.27124349039006467876,0.27308955943559964918,-0.45893533425949833982,-0.05643824130694662794,-0.27242675566711338497,0.075794423238180932967,-0.20684325096453112791,-0.11705565922890305564,-0.4770122414521648091,0.69291879399729894295,-0.23075741638079869111,0.21792328233262162063,0.54138424431909792922,1.1342053487715331173,-0.058562514491000201844,-0.084915981944580803953,0.14739414083063495653,-0.014935705714400400457,-0.13401919611220319828,0.47584981434610701401,0.203944120546841412,-1.4068258662383983371,-0.82300317233202902045,-0.04146397278428250871,0.8456470858347658881,0.61969721559308743597,0.1243768264120631295],[1.0892086498856405896,-0.16508530142939067953,-0.64971412784391979756,0.2787793665888345096,-0.17042828287203501403,-0.4308079899940407409,-0.22415944298728443518,-0.50452330805489076226,-0.145785552007937802,-0.47040887673095344024,-0.035268370525624669065,0.27834307408611802526,0.33751558622039606883,0.29374554215807058277,0.065394081100617243441,-0.2333891233250088848,-0.12780400641440561871,-0.039977441208814808171,0.036987358317205225322,-0.5035276849160389423,-0.24008954293790663037,-0.34268456331937879877,0.18505246679825892997,0.7731646690494428098,0.058003587604862773264,-0.33473358025613131339,0.4445537047555807586],[-0.72660978429445832738,0.30340195848549322832,0.25032059496291886314,0.33438064506351405925,0.38319972841828031651,-0.42694042364103101939,-0.28676355057623542644,-0.016423351302568344606,-0.12654937068253541144,-0.29256147127124726426,-0.33659301829027171715,-0.22333416938362168902,0.39195523543540888856,0.12305591089625789181,-0.067761318646057361326,-0.20702651814510983352,0.094964795342930716227,-0.32048190107807644766,0.53370041061432205165,-0.19935189187519503085,0.056050798658484390913,0.4836587627463382888,0.2898428897328198528,-0.29885126511197335208,0.087470206199602537622,-0.47452770405262717501,-0.11754600276640674028],[0.064259380463872972644,0.82413769861396091176,0.725934121861553594,-0.049432412993510192745,-0.18923037263565495314,-0.28612317650973456695,-0.38654317637809937347,0.03871129336625152989,0.01315962991547609158,-0.72137377781843836644,-0.29162940457113956105,-0.17157189799256972185,0.32591134957659917415,-0.20475911796873300097,-0.57310430931325051507,0.1710523511001610375,-0.17072788542053762839,0.22238327615862088504,-0.27550993894282566066,0.74137751458675571481,-0.30742742306550185916,-0.3495155600199797985,-0.057789336977882271862,0.20867874913466571973,0.25730037616716866511,0.15617601375738351943,0.57881020588393050641],[0.14752154769293135406,-0.21828225798074379904,-0.019972915993840423959,0.46588343734259929363,-0.46426820417814163022,0.28318547396891313728,0.33694113235929262773,-0.42479130272060972029,-0.06345977733494910511,-0.42386129690537321935,0.44748471166983411207,0.3349313185208402377,-0.35629022145763838969,-0.14658876379486635022,-0.26367576521831420644,-0.20907769511040980026,0.17252428952498077841,-0.43810787758255809177,-0.2584469199715913601,-0.37034771762710483323,0.12987277001821873057,-0.35847383108903757565,-0.18197874540368838558,-0.12119007702693342099,-0.093167125943368900298,-0.44217383045780600526,-0.042110118628210652103],[-0.010949595092472895128,0.45476673812010826037,0.5851854813787830123,-0.10952579309389239015,0.17731358821838352768,-0.055921920329355861989,-0.24129743649342894063,0.34964000709920600718,-0.48843894413015842559,-0.090775167778390786211,0.2093254194073938812,-0.2864962281949429701,-0.11563288067114430024,-0.35496592819733374657,-0.14828871986597724764,0.44226982629134053981,0.30746768988719264115,0.052046587523475990045,0.50558635787180006282,0.13697850272110936865,0.22285023931628447635,-0.56551798054197355281,-0.38775887023532151776,0.4770617978730315456,0.47250932532674616571,0.2294432574158483118,0.44941431236282897155],[-0.23299988635898688516,0.16652476972251620269,-0.15056508511942501283,0.63011684046097893308,-0.48688689677872942774,0.088902877119018897112,-0.0046370769537957354928,0.19541713985660033592,0.54212189924057785362,0.7308328462338661291,0.089130804125409426875,-0.28462461572790331843,0.22979775659217294148,-0.078201124245887168596,-0.55253632058651858117,-0.60673946273165668686,-0.63251194784032194196,-0.39798384138442366442,0.14951701312336901362,-0.36306686574695062886,0.05693506355404846786,0.31012954608812298707,-0.10890640913151392044,0.19146561932111708093,0.36728090529550339038,-0.28978093677142424678,0.24030278319834635914],[-0.027628940823885339562,0.4047150759721104829,-0.0056136429921812783933,-0.51461898461912014557,-0.12186603876579504835,0.33212479790325039053,0.053266465480437862057,0.20988948926432618447,-0.13593867279425064787,0.56500136537408651716,-0.42971770460786745671,-0.2905251149736695071,-0.43522964408997216745,-0.5132540172743544904,0.13326997719804470344,0.10337186520720796634,0.34905949812931624798,-0.42865752355276015573,0.55987097167191834934,0.167883592315317548,-0.24584917880467113682,0.40118874022882838881,0.95225759205287130449,-0.39417510907646968743,0.2733152032641543161,0.073599899230264193006,0.042219408013986201023],[-0.19222933733823671654,0.19254993703771430824,-0.16573694018719731247,-0.47659234814338402586,0.35239072864721870948,-0.20359344484569549816,0.1124761841635576326,-0.16398212550784263541,0.31317747883302099465,0.095262863945119902187,0.10331152475860744255,-0.69406069472386022756,0.08706608673467974846,-0.53629835686579496734,-0.24699579874963883963,0.67579370765538715471,0.52722109193633970303,-0.080452207573520492789,0.45560069580322587468,0.51035068741184963503,-0.27294248556527039851,-0.09549020002320622591,-0.829773762946028004,0.60946522298200167533,-0.13988199812301294056,-0.30735467306145586308,-0.58381489884479931263],[-0.2946700769635233752,0.22148144617466752893,-0.21745193503565432569,0.39884437937611055824,0.27629617422630142753,0.074523681894810164805,-0.11918146432188612971,0.21369542832668783627,0.19600407485101212224,0.51887666184653447043,-0.28961751610334368623,0.044673041614868368165,0.24309155176844018942,0.29988982117253826232,0.49615177737114529721,0.11479074295694538521,-0.3608573063574971318,0.32627894041289828841,0.19218826594409979536,0.39702728793865249557,-0.43385775250757685484,-0.35153716199485179894,-0.21863886317308167673,-0.35959096583168970174,0.063519185094779162526,0.48297414414433109675,-0.091333089885062071489],[0.17310203233485782492,0.17902868803719285129,0.31446761178380844282,0.062573677836021635024,0.18819336381254939128,0.37593655888681265509,-0.065989879841980930708,-0.20976252514133683635,0.26052350426434661701,-0.402143526325307199,-0.62777248378961370001,0.3825703705508450847,0.41804868878106982155,0.19066140364724329381,0.0023898202101105131545,-0.65039133823081141106,0.37261234374396312585,-0.61641504597431562296,-1.3085728384374573086,0.0070323927805560938753,0.27519008993483695669,-0.067915372309323290834,0.18170918157853066521,0.79474834066147670431,-0.0022583610923106890028,0.33706635560508230176,0.60324425333836617646],[0.37552079598195881038,0.33356051348865850548,-0.2002580242322945514,-0.18689332008771397664,-0.328763038915574346,0.1662295787164624894,-0.043576549640042823441,0.25212052793834016651,0.54258318208316835829,-0.1359406660163269831,0.066462621049024520059,0.16114827294358716192,0.11955322125776678133,-0.2585808773876537292,0.42976924945766514785,0.79506526584477121844,-0.46359797217317189055,0.4704535167151664421,0.90212015573884996034,-0.10335072450417176482,0.040995297795962407084,0.034717664480240169322,-0.039716620199224256238,0.12201782416485965066,-0.87978253522366889339,-0.48184416326422496724,-0.27869661352075980609],[0.26385854219301901891,0.53954643819488667944,-0.20782581071801983774,-0.71287690727032404503,-0.31159336437230700234,0.12026327030831672482,0.50484723021458799419,0.019711311401895640488,0.11205629033902070324,0.12749794009412393492,0.019320246024203697327,-0.21885642912042002628,-0.22451984563699256547,0.8242039903624913677,-0.31090621304266319314,-0.19783969556429575887,0.6820934385044388204,-0.094178792565562732819,-0.30565890587143706991,0.092842592742492874303,0.19507255359241143511,0.37465185526148131467,-0.12346902675477572364,0.20170292127463354537,-0.24638119421325974101,-0.66950658312948074791,-0.12583924233862689435],[-0.43906488995373749162,0.41782763231407921145,-1.4452868751233325373,-0.26151066499356134809,0.20337151675161824205,-0.59190110883819846421,0.40852419448746768449,-0.41082462026344601647,-0.30370083296714500687,-0.35969621165193643719,-0.04179467090142693908,0.16875198812099873047,-0.22610977105238430629,0.27607101500038500053,0.42579956844390565163,-0.055068076090519821331,-0.023074240583733522658,-0.29262450892265090552,0.24339852869150857551,0.32262707424817060886,-0.19047474508462208798,0.0048953002213395647307,-0.057003514857098917801,-0.26327577192082080026,0.23179566238413482071,-0.082777343509206999239,-0.77349870081779004138],[0.33484114933807468395,0.40595897191951435534,-0.35454304415871268352,-0.044426727615800735982,0.0086035689500207190167,0.22586143656767279642,-0.0012665287661763342374,0.017168442316891838195,0.22433700469786571619,0.12397472338695933458,-0.39886117408399873741,0.21244572526844537896,-0.29352628339278874492,-0.38086974953447105818,0.35698985628267165815,-0.41431765077867682701,0.27092204081369652968,-0.40226556505332233815,-0.7360923298428098116,-0.13847330646665562126,0.28787070509636536464,-0.37798718596313973794,-0.036407257842591002339,0.012111825251431285189,-0.0089289382948125866485,-0.40897756943334578894,0.4844012127888601138],[0.28825153125616587158,-0.080676048037677278169,-0.079547834671209058377,-0.60378120665468071326,0.46610105577223825968,-0.66310811831003968475,-0.26513118919836470289,-0.13020883330130458844,-0.28225248393009505499,-0.09908226298941245902,0.60927527490686428369,-0.14084426036740260724,-0.27889682310283042677,0.0035665458144942471796,-0.17485176660133536219,0.64711647473434263933,0.20665669733465269475,-0.31506109386024888641,1.2234760986093768942,0.83098287429548256533,0.41184373488263226193,-0.070126082819107121713,0.22936455163492502907,-0.42892694546204951367,-0.4542780411599640078,0.24644069431532447667,-0.093413582010489187857],[-0.059993318910841759994,0.51588437712827883708,0.087287687194419621983,0.19483940110073011409,-0.41471664768289578928,-0.41979946291414038662,0.48426652201031511469,0.38321843208173644868,0.2772012498322461993,-0.048924230369294059717,0.16029755400183692826,-0.34908061406468354759,-0.013190283835587873762,-0.12297139738530589448,0.035726263943139449641,0.103260528598109802,0.39663959350675992432,0.16350125481480795586,0.11037248350665550267,-0.33251062949636456256,0.21132489438389390202,-0.11190860529967720793,-0.40448672283568976038,-0.38441831784751734347,-0.42269814515082226869,0.48047144513558265322,0.34001605948722407602]]]
b2 = [-0.65247487490848499192, 0.25629903320518587773]
LW2_1 = [[1.5545503947216356977,-1.106394867342936017,-0.47106764665690342708,-0.30526852696589279468,-1.7298751789885615793,1.0464669277034668315,-1.0153446747826362362,1.47771374010474843,-0.84095849192024285657,0.27689121073659161976,-1.1174817075679603917,-0.10372871306806703828,-1.2767256362710619477,1.1558772452240586581,1.6862523045676343081,-0.64495727366815025494,1.1976405191487902169,-0.99298720348965541227,0.71271402533798278167,1.2478995215077208769,0.85362063219393657931,-0.46529571281911696889,-0.88435220675668002599,-0.83312123774014235078,-0.085768739165803770108,-0.9517546380345537349,-0.55566106777407364703,0.37384915919654132521,0.27972658622913748605,-1.0729356836761221317],
         [0.79258764731608344345, 0.61423264899604801403, 0.56043824809814346555, 1.3645919193955176052,
          -0.94745851240785106118, 0.36540918203458266911, 0.12708204986375251644, 0.88204253334503146533,
          -0.50383049201096286041, 0.76498974026609989352, 1.236993146705367419, 0.69876935099578263433,
          -0.97068477139412834287, -0.90390500889466673939, -1.0530850254622492468, -0.31216698514836166423,
          1.2063911012038863735, -0.19854970327608309488, -0.42861192363704608832, 0.5088476063639548741,
          0.87437428126574712195, -0.82340866864812878312, -0.033199863833010281877, 0.65779808057909827657,
          1.029807166819154185, 0.67695313244200938652, 1.2241251966732955569, 0.31139033781968267212,
          -1.233844164438656632, 0.30950302930397016743]]

y1_step1 = [{"ymin": -1,
      "gain": 0.916590284142988,
      "xoffset": 0.001
      },
        {
            "ymin":-1,
            "gain":0.614817091915155,
            "xoffset":0.001
        }]

for i in range(0,2):
    x1_step1[i]["xoffset"] = np.array(x1_step1[i]["xoffset"]).reshape(len(x1_step1[i]["xoffset"]), 1)
    x1_step1[i]["gain"] = np.array(x1_step1[i]["gain"]).reshape(len(x1_step1[i]["gain"]), 1)

    x1_step1[i]["ymin"] = np.array(x1_step1[i]["ymin"])
    b1[i] = np.array(b1[i])
    IW1_1[i] = np.array(IW1_1[i])
    LW2_1[i] = np.array(LW2_1[i])
    LW2_1[i] = LW2_1[i].reshape(len(LW2_1[i]), 1)

def mapminmax_apply(x, settings):

    y = np.subtract(x, settings['xoffset'])
    y = np.multiply(y, settings['gain'])
    y = y + settings['ymin']
    return y

def tansig_apply(n):

    n = np.array(n)
    n = (1 + np.exp(-2 * n))
    n = np.divide(2, n)
    n = n - 1
    return n

def mapminmax_reverse(y,settings):

    x = np.subtract(y, settings['ymin'])
    x = np.divide(x, settings['gain'])
    x = x + settings['xoffset']
    return x

def removeconstantrows_apply(stats):

    result = []
    for stat in stats_to_keep:
        result.append(stats[int(stat)])
    return result

if __name__ == '__main__':

    #if this fails try to change the os.popen paramater for this scripts location in demo.py, called path
    '''
    arg[0] is the script name
    arg[1] is the core number stats are from
    arg[2] is the stats json format
    '''
    core = int(sys.argv[1])

    x1 = json.loads(sys.argv[2])

    if core == 1:
        x1 = removeconstantrows_apply(x1)

    x1 = np.array(x1)

    if type(x1[0]) is not list:
        Q = 1
    else:
        Q = x1.shape[1]

    x1 = np.transpose(x1.reshape(Q,x1.shape[0]))

    xp1 = mapminmax_apply(x1, x1_step1[core])

    xp1 = np.array(xp1)


    p1 = np.matlib.repmat(b1[core], 1, Q)
    a1 = tansig_apply(p1 + np.dot(IW1_1[core], xp1))


    LW2_1 = np.transpose(LW2_1[core])
    a2 = np.matlib.repmat(b2[core], 1, Q) + np.dot(LW2_1[0], a1)


    y1 = mapminmax_reverse(a2, y1_step1[0])

    y1 = np.transpose(y1)

    y1 = y1.tolist()

    y1 = json.dumps(y1, separators=(',', ':'))

    if '.' in y1 or ',' in y1:
        y1 = y1[2:-3]
    else:
        y1 = 0

    print y1








