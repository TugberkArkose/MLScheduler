#!/usr/bin/env python
import sys
import numpy as np
import json
import numpy.matlib as matlab

stats_to_keep = [0, 1, 2, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]

x1_step1 = [
        {"xoffset":[[0.001],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[8],[0],[0],[8]],
        "gain":[[0.614817091915155],[1.35655023848153e-06],[2.99007295778017e-05],[5.93764287453167e-06],[1.16171003717472e-05],[1.18808587484703e-05],[1.93860590196935e-07],[4.32579275559487e-06],[4.93400521326991e-07],[0.0181818181818182],[4.32579275559487e-06],[4.32579275559487e-06],[3.0155392244003e-07],[5.80664454335096e-06],[5.42832319910628e-07],[4.93400521326991e-07],[0.000146391450739277],[5.80617254202943e-06],[1.22574555973671e-05],[4.34513399306951e-06],[1.22574555973671e-05],[3.15651583781822e-05],[1.33244503664224e-05],[4.93400643049058e-07],[1.17234668636209e-06],[1.23411386921849e-06],[1.55071252526789e-07],[3.0155392244003e-07],[5.42832319910628e-07],[7.23687133841449e-08]],
        "ymin":-1},
            {
                "xoffset": [[0.001],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[1],[0],[0],[1]],
                "gain": [[0.826104915324246],[1.92803419561449e-06],[2.03786350390251e-05],[9.63982249230863e-07],[2.88844118050591e-06],[1.38968602823564e-06],[0.03125],[2.88844118050591e-06],[2.88844535205816e-06],[1.78589287500179e-06],[2.24122281116577e-05],[9.64005016682107e-07],[1.38968602823564e-06],[0.000206739714699194],[2.23216776972957e-05],[2.79329608938547e-05],[2.89787875275299e-06],[2.79329608938547e-05],[6.72449734382355e-05],[7.71206243685749e-06],[9.62596855292334e-07],[2.20332746513785e-06],[2.23275836084278e-06],[4.07666577659464e-07],[1.78589287500179e-06],[9.64005016682107e-07],[3.09182806653305e-07]],
                "ymin":-1
            }]
b1 = [[[-2.5452471202706368203],[1.4477837288178374564],[-2.5283394872721469682],[0.82975202324818997379],[-0.38490075562260978037],[-2.7030370237409622192],[0.78680177750398017089],[0.89811198012642057265],[1.8654371469017927421],[0.064500370226275374752],[-0.46919155931578748753],[0.041025104797379217947],[2.0756403451766756163],[0.35464116995085642747],[0.094066978795774594535],[-0.7487046903094286554],[2.3382622342926024928],[-2.9137477144876853252],[-0.4702029855860557217],[0.80575677284957614166]], [[2.9442993461620980966],[1.5769275167386731518],[-0.70661697775470344585],[4.0552754222267610729],[1.4628528058541643286],[-0.59743999252898982721],[0.6698085621324557648],[-1.7573403992466472001],[1.0568327011675635596],[-0.25086308016727554282],[-0.16601202872129433574],[0.25912914572699308202],[0.11046162004669742018],[-0.5886854307762199312],[1.6969585785258172184],[-0.71908638630297305738],[-1.8269132608672451479],[1.0865335445525803326],[-1.3223425274618720859],[2.6633139741198630368]]]
IW1_1 = [[[1.0567473233122901544,-0.37930231277605952478,0.25963347542813769442,-0.82848513316531657846,0.39750349581017413447,-1.4500822245805780053,-0.30979305724304340153,0.20809692292171186323,-0.59629273238469227003,-0.042070426435034467827,0.18602033149212168772,-0.32394406396561609141,-0.37721207149799562686,0.4920963454511195212,-0.31975279968258529806,-0.9283723679072236612,-0.31806056666155535506,0.36112521583598616859,-0.36005974961273284896,0.11221077915851503104,-0.69271844520085434915,0.71955893330000042507,0.21059120342214066035,1.1705772429988667849,0.82791154060684235549,-0.55418611525124961137,0.9032477452462288614,-0.69638726908623160838,0.13266672213129404589,-0.23597085681328516804],[-1.2779974727345408958,0.71611724290726475051,1.0830413153656686109,0.41893962114368971106,1.2069021805298074668,-0.78501385077928242939,-0.13256402936668909565,-0.02526420189379667558,0.1410421186917234504,-0.14874831080982892084,0.072052617984028344278,0.80899723716057314604,0.45939162746629436107,0.061042052398875272512,-0.43734319724773973448,0.43501350750439854442,-0.41406961322522062297,-0.34820892723809548919,-0.75338894134094791522,0.015740874509304177142,-0.40947608940806634603,-0.59339063117361356969,-0.83286660227394637701,0.17263176565524726569,-0.49270971163777899093,-0.56091066772071362934,-0.43741072915577938751,-0.038944812945391649173,0.22546938107343095226,0.18528228593971324267],[-0.55356357806321132564,0.87746060162552796946,-0.7049875631988624658,-0.051954317325207187428,-0.123130442324737438,-0.89032004177214929541,-0.26119717105499901111,-0.68638615283038395543,0.42872882556431668455,0.030022911884190688764,-0.62976591239630286267,0.94009559474497250697,0.53957074979760344391,-0.19137384197391968388,-1.381411376241933997,0.25490589637434857284,0.31241230822594023842,-0.10317005593590701518,0.09679485867498700824,1.1129097699300640745,-0.27691046777391281619,-0.029854481223690380876,-0.35830349048287368774,2.5849175960461607815,0.22354145806680830733,-2.5683641361201030584,0.23555190576385764967,1.1642393150544223523,-0.87249766527100014457,-0.11877851959246779612],[-0.64531549399210674789,0.12734547918499672381,0.39097708965976496476,0.037743388081543469137,0.2656477971895696566,-0.037840827241550169246,0.61027993136202673963,-0.3551776883472612667,-0.25395443058690636562,0.22144697173593769213,-0.03565321730719368809,-0.32760244302379948333,-0.025355301528777796083,0.083569639673803791657,0.01434351066434593619,-0.47029972588445778658,-0.051565759597838406458,0.53556431134832682694,0.031482425440367410585,-0.12815178702559512636,0.04825918869953935153,-0.60678614688747345429,-0.45784555440189150799,-0.2452964043449957221,-0.088768602363483301021,0.23267040346881001645,0.023717063293202646224,0.29131451681092895845,0.025072133532797212518,0.19213648733153043668],[-0.71223088678267754137,0.041924169720379635129,-0.22059189229787001807,0.250604567033590242,-0.23988589041184754658,-0.41500035462213619164,0.13869084380691693026,0.25512785684589994739,0.4633677570427785497,0.30552363524591497068,0.09307220141583479045,0.88889089985078906242,-0.20521177533705106666,-0.64889940791794276098,-0.643930274730641794,0.22181940513282433214,-0.9833303933605511693,-0.37275663154313332104,0.35887404138459877423,0.26863261071037464189,0.48001873980694176325,0.68572415729132718543,-0.39869257700278765144,-0.031270502871679824175,0.46836356573278814519,-0.46382001479292961355,0.36365528178658196312,0.051782929096441568384,-0.86337687282650132925,0.16550458651445559832],[0.24329258006071624587,0.78868528474411081497,0.35212837251976136788,-0.16349594809891920821,-1.6070962108972062232,1.2992232107883097125,-0.38134247037660912172,1.2580047970755254827,-1.6768300535572278065,0.009830289153983883671,0.85932662365419576478,0.28686919939234695187,-0.94808513162178809086,-0.92542165422431799104,1.3884787508719143023,-1.6615112148325783537,-1.0931471903192704342,-1.3587285874591790158,0.59070534275185171413,-1.4337462971223480235,0.95540455729964168796,0.4253715710415383322,-0.29651040235545361723,1.2554233900885367614,-1.1597810664689069959,1.281194149400841642,0.18671521473992430673,-1.1610002891173694106,1.0996307445381940937,0.16149582253800082166],[-0.64933378798198659876,-0.093140069329527036546,-0.041175415078527385915,-0.31512293623642001483,0.079202110497015115742,-0.15913228320528066684,-0.26669315011053323916,0.10794134883839311134,0.22162880755195665805,-0.41369440179967104099,-0.098928297900493053496,0.1174140349783081988,0.40350047681143214051,-0.44778260789776302975,-0.021525966280147128262,0.179549031324586994,-0.34576261886376530308,0.02937951102842393386,0.080492483470288880842,0.2679037701224454282,-0.45145160261956762682,-0.033536064290627179418,-0.0098358196260842582076,1.7919342312443022891,-0.16124664782498890347,-0.52981600659250582819,-0.79957141949679388926,0.60562836983109280542,-0.076988713685341353399,-0.11016898203901771824],[3.0181179279799374982,0.30272055172648409949,-0.0092721810838239208941,3.3747678843268937854,7.7940457977303445603,-1.7901132432957926888,0.092858296857679475944,-0.11636631923496604246,-0.29420238712086022037,0.47383892710904662593,-0.6916482369770290406,1.4027349277775946756,0.3003585091198044954,-0.11023107215572221229,-0.49861159923961112517,-0.37978541868446347163,0.46458749343586352998,0.090462369963521707672,0.012965412720155163745,-1.1989305474327101031,0.38461635608269190145,-3.3327980246866526493,0.93132264716888935041,-0.15726786343819210146,-1.2247333724296081137,-0.16378008673346039492,-3.9048659690281164458,-0.45885796949628993024,-0.32376151736805119929,-1.7752444731041383541],[-0.26289117741500994674,0.35705326613075838438,0.091690691745991204087,-0.22844685379404655601,-0.62450469287867871326,-0.052439084743052033488,-0.30948320537575024769,-0.38401666095446590488,0.5394937666483617944,-0.31810380277332023224,-0.092781819689522149197,0.59280363737271613012,-0.053528220428225053995,-0.61723875114086146354,-0.93840817029845069452,0.21268654011470800036,1.395669900076110137,-0.1900454357362213742,0.58586316292415041573,0.89054209099521108861,0.34012476152088455539,0.35214082776534166852,-0.68175406257483517347,0.74000245672641884465,-0.14019973078815156642,-0.15657574158698300826,-0.25878054096424979447,0.64954291944601760811,-0.15430240095365518882,-0.26075423572068606726],[-0.040934324366294190523,-0.16705854544466142153,-0.78430172418836852088,0.28201805155937559322,0.57767783376291437225,0.48927086378427031566,-0.32402301249102671843,-0.058428112845379728824,-0.69868224271278100979,0.58708585675724833663,0.81166458020738574408,-0.024367515502410900391,-0.2032644823421825564,-0.38393306206412103343,0.36526482390395831334,-0.28164238292347426595,-0.091816464547706963528,-0.52904836814421196678,0.63583210045252713805,-0.86310495998574232601,0.31114430904393480803,0.12760316004835162151,-0.77143066656213465926,-0.62057025128828524618,-0.012806865061413668164,-0.046552547633912005898,0.23372072656828626891,-0.79433170135592567895,0.66762236546012865279,-0.51033839967261285242],[0.19100109202375004092,0.090036917260087806492,0.22608976794051793835,0.25587714468732797313,-0.70484918011039598973,-0.20712612232734065043,0.45520872430064179825,-0.38633589244680049957,0.20591562915571037795,-0.06564704999096039606,-0.12042436182193534677,-0.066460930334342777082,0.075284760786665946841,0.32486692003074535418,-0.76306350161835156953,-0.17325966810253762285,0.77868083431679324669,-0.15833025962206578874,-0.13507645581124724798,0.56725642882862437055,0.13743152350668763617,-0.011007772904389586527,-0.22034888094367172107,-0.88663873557215455712,-0.15774874975080799278,0.30870035619906038837,0.15274183079297512511,0.47590025969981786247,-0.0036878265468757946005,-0.29249919212892050435],[0.028757656473612946968,1.1119200571073806216,0.01295287667408380472,1.8646951290732616258,4.0660589589265052624,-0.63838927634156894531,-0.27246801351620530962,-0.42572569097993556708,-0.5177837783646598302,0.61722476175554186195,-0.5997070005885614119,0.44949414636263707035,0.253191307359224127,0.85699372347917146531,-0.71353675426057960873,-0.2595780753995758916,-0.65368250670984984207,0.19392566245779957468,-0.050182496836659845618,-0.44897562255938877618,0.052159859953677403799,-1.449844374690157256,0.40772925042828206399,-1.5778783848183925986,-0.47336559570106090389,0.056739472583659744664,-0.26322977239386025072,0.38387938918185027237,-0.64971119447069636266,-0.34028003539627421636],[0.49674684156855275496,-1.2852737551433066621,-0.083294626184435463512,0.63460800026824004672,0.12087734211456910294,1.0058587839157031585,0.044703528254236755968,0.42494175135445183544,0.50160067621135517868,0.095448035249375076661,0.15913907178249667163,-1.0309029260014836993,-1.1389585859070638918,0.19603555609592601683,1.6259118510326928675,-0.38240418745217341634,-0.40688335337259307067,0.44317301456846808216,-0.25652357234764222582,-0.93162179368211650576,-0.27383048503608808932,-0.44299318420617245229,1.2940443885933854418,-0.28428562080851382809,-0.31096336948384289967,1.0129298234560031311,-1.3352511756577420954,-0.67377251794147408059,1.1000794597815202192,-0.082227609615193902881],[-0.040056714852739629118,0.43636029657491071099,-0.20723546285246985388,1.4986085240548581154,3.4319734771967600473,-0.85785253518128512518,0.5264394461144663584,-0.27678361571587201118,0.61635516512941401768,0.23384617108571237321,-0.2905634173191687375,-0.59447126362879587624,0.27297453802937499123,1.024279069342919346,-0.38720859309763244749,0.48675488906471231498,-1.1177603872608945501,0.77894115923806639401,-0.16215511465131768332,0.065443714604443509186,-0.5754366632499906542,-1.4852494738423540621,0.15261220850899512302,-2.5465575345442523769,0.19762079244906194386,-0.46311038763379425154,-0.2482077893459113116,0.084729072485756340427,-0.15310461544518536026,-0.91350034291332682379],[0.19914201702622072454,-0.19733652469749102254,0.22333819450011418994,-0.74601514627679543779,0.27204498617012728978,-1.6237598109785054135,-0.59262299846043453577,0.16449700800271663259,-0.28657495694458828828,0.17688915813686073575,0.55460095821781241199,0.0453335240859173913,-0.58435374129194084247,0.16559927407318067449,-0.084055191791617078767,-0.3842036447559166179,0.3777288172726212534,-0.22475804908872387688,-0.28578639815826761827,0.42111693641811881461,0.16629324876555140467,0.93752691416562905502,-0.58876539678467676442,0.6940435889375152767,0.77773301736287903108,-0.14462938341809614129,1.3457859973310364321,-0.29173268986345568532,0.29789936675209649497,0.45696456200802509917],[0.20566164826712748925,-0.18289926974381284785,0.45861721811531930282,-0.56719539666407092771,-0.34962839823728014688,-0.44775516529627173989,0.55018809504004517752,-0.94769425685041452923,0.2537466379147635398,-0.54330836627636114322,-0.6866443311405489025,0.75118577806774644579,0.64974346707152230707,1.0012426748635148144,0.18385649691564159847,0.75613870836283270105,0.65929496584894942135,0.50962651952965420943,-0.2847790315815796891,-0.44843263617369005791,-0.27289055985891985667,0.13567867507575767649,-0.35204251877956399541,1.1181958631821766748,-0.1927199906018169373,0.50515071654453047589,-1.9559678583331252533,0.58161617600034054565,0.95176165078552166232,-0.78572165019218753734],[-0.012492998077980578542,-0.23846486685191162214,0.39441606571506510059,-1.8717551964372713957,-2.6720747205743311525,-0.37481508176293748535,-0.3211454108327489454,-0.97832508325169564856,0.24031231637221750486,0.48626135196666697702,-0.3955683731421353877,1.200609137688996686,-0.59206991058876479173,0.2697703568464558388,1.3991172722710478737,0.77471572578214031868,0.44609483592096782489,0.15178668716413917794,0.084125586962246923228,-0.65123556248351532894,0.14983616676215047447,1.7768766596465062069,1.4536870726039088364,-2.0735816952322410067,0.35576656891069752264,-0.45893898921534342916,1.2603076439811928822,-0.63751196097181894729,2.2970336511803592927,0.31620884464817622383],[0.16131183214643349255,-0.73766577329239035876,0.54854407702301488658,-0.4052852955791534928,-0.71874752946433562162,-0.10839698823998636379,0.3213399561648998537,-0.25631940928586693929,-0.56896680214749484339,0.054612817170678985834,-0.77658987246527000359,-0.052646803844571446462,0.25141490962531165554,0.53477200186526197001,-0.91990410175400250115,-0.38008745398698545737,-0.26069319887234737587,0.19277214003086790006,-0.17606906176478925863,0.6043540594546911171,0.23747935097627906331,0.20488212542456918364,-0.052544744110742259979,-0.16104803693567631973,0.0079992870226053211513,0.47167220070604842785,-0.046663172090516187585,0.40780809615100527266,-0.52345166787821317822,-0.27253570637237356511],[0.82030785705263220553,-0.0025913292717892229267,0.36452706324095024426,1.4468660433568245605,1.2817252206973777096,0.92956622943709354967,0.58282353598603531264,-0.33912339603187835468,-0.70716729309488179922,0.16450971573441558471,-0.38987422081229761162,0.27489112011902189225,-0.21969349207143612501,0.089284394166813926819,0.17489859280097644345,-0.71004928867480643362,-0.48698027731785514804,0.44040989284698278672,0.27083884333441810011,-1.1045130487501158001,-0.32614724497083796839,-0.88379834979074234358,-0.50937335775208336663,0.51272352842359980585,-0.5280184457839751655,0.10926060189734787542,-1.2015690344063221229,-0.089870171194437464823,0.13830137463952288379,-0.091475918777649239955],[0.20720101738933754953,0.52886523329910872793,0.49470726983123997078,1.3067292991436743055,1.7604647824966312974,1.0954804501359196589,0.21800841998991449255,-0.52328758508397432703,-0.4119030572585629657,0.56619636761235292433,-0.15932997761045331053,0.35803408590217844498,0.44473428560189487424,0.028578429827713192068,0.59005345995932712011,-0.89810019845398825211,-0.30220900097039332666,0.34551764573737542285,0.055178582570802971186,-0.87841987279535038713,0.0045493951944536592524,-0.73208755703246253255,-0.62176250891575024493,-1.7286048432456746493,-0.60386175391013940938,0.28536157280557838956,0.22251923262611919552,0.36836590275832015173,-0.22884279501377594035,-0.24466207850154120251]], [[1.0520879016479482981,-1.3751598818140930991,0.54640725755486518889,-0.26468828238837754929,0.87942818321436366791,-0.85046238062569146088,3.0521286516366195052,0.40320138514333442314,0.4149439145507164417,-0.6089970617768020178,-0.86513034901354490813,-0.17852024870638996679,-0.30401586304263039651,0.99080419787873419413,-0.62939291059363600134,0.15126325550523397889,-0.75322301162147387021,0.48125013114246512069,-0.86553758163939620296,1.4579671079393408117,-0.24754977130079577896,-0.94037958039026248169,0.58749541839838581581,-0.32153447991935779626,0.15499994865137400879,-1.0431002864785532402,1.1539073120202698597],[-0.8378722616181131233,-2.0065868370968424905,0.36488099616640962131,0.33876111171128864274,0.69195357805003110396,0.31371305369960855725,0.28037845824007279205,0.28257569367607054955,0.19011184150171908658,1.1958312644950797043,0.23668392180079247944,0.32311222444375653495,0.26407775075901551709,0.53671092187143487617,0.61131889500989677888,-0.80167139107469775894,0.33718490904745446191,-0.51173929306205900858,-0.99184613948281741269,-0.3416729302011490832,2.5433041581541395715,-1.6757616719213681566,-0.13964322772175599696,-1.6285131160231121061,1.2676575039461122074,-0.34459083773770943226,0.11207204528045322522],[0.0063183929709592348209,1.1159089886654356416,0.63056196794988328413,-0.12258223788007230337,-0.77829627618065655437,-0.8880147591827326492,-0.71808770006075994807,-1.0077574174542851537,0.64974406119715588659,1.1942481100277690942,0.020133240338437573269,-1.3361224698963483082,-0.72034161761443094019,1.3789061948177097072,0.36268345154210651637,-0.17957710330380499686,-1.571277652424229121,-0.47747459619046855872,2.454306482178878035,1.3149919578504909445,2.9596479565868292205,-0.11693106985522558339,0.51813836158566151102,-2.8828061147072032711,0.66116881290117512915,-0.67549184941545570293,-0.51283095823087410103],[-1.2075586000751126203,2.0153383889225380265,7.5239192699710359946,1.5597193901641286384,-1.2432698593193709513,0.499232109148537051,-0.65900109695273800803,-0.35209692308680951012,-0.38014765445220272122,-0.67354049358354484145,0.26533665189705929466,0.39503282890975932595,0.017545097080994311034,-1.6103634028928137667,0.17431364210881736265,0.0095491265951252648353,0.97488662603084519365,-0.017546115836295991808,-0.345496493847553654,-1.6033580644171920859,-3.4145317275586655192,-0.41619439268529434539,0.032438913923716228283,-0.96265005517433044346,-0.15252099158611537311,0.6874213294190480994,1.138082286931727527],[-0.71845331580245797021,-0.14040524155796418881,-0.60153101974682721131,0.44240618309369483807,0.17530607211112450572,1.0010596863590484062,0.59479679258194839697,0.030411627867787161678,2.4711681880827374158,-1.365857025402310132,-0.35068959583202868879,0.42971106675771908456,0.80755368110295755457,-0.92659078810288308947,-0.27829036198410767033,0.66068996651736711101,-0.79366691678670775456,0.44515224120607593816,-2.1769220229081160944,-0.26034297867529110349,-4.0085818085436537572,0.023264072332082569999,-0.39468076631147586131,3.1541605992341170683,-0.88432398367301257025,1.0359331405917362456,1.4436233987421449587],[1.8093394655505206092,-0.68245529554352213353,0.67338784579600685642,0.1325064373591586242,-0.11856378094764885578,-1.6914448914402366864,0.75495216589499802851,0.24043887882223205499,1.1372645961321823371,0.1207234017304461976,0.34188896839053606325,0.18575183293726291178,-1.5687342049026953283,0.058328218413288564215,-0.0070187521378313180373,-2.686167563732338337,-0.074772070324362560623,-2.230893079527825229,1.0042717120069133419,2.2196654739828156622,2.9193449172123586699,0.35221496585076961239,0.87019970482139374912,-3.3870199554274966758,0.33499706056835676371,-0.41635211627358326147,-1.4836464521154864027],[-0.47297652545666679647,0.96660582307654807632,0.59365555273950532111,-0.13231582481411735541,1.0340452117946756783,-0.65121510955376005203,-0.50839781938086037183,0.57042743985631672032,0.63808849640496190236,-0.77164106785057595683,0.30259940989445421877,-0.19421382848265292265,-0.72591600960547253418,0.1312377452279113732,-0.15046457888785969015,-0.90514880570182398856,-1.2689049483019814168,-0.80563752952139400243,-0.59410760722882971496,-0.3284082332584654651,-2.7411592302141856159,0.57382818803747615011,3.9309921115012333992,1.9148559054842628768,-0.32165925745978746209,-0.56087486503633010582,1.0468010664627664941],[0.75343400329042020669,3.2831090598883863052,3.5982930821712013625,-1.1393397726119787183,1.3937301332412437294,-1.8449449505931234672,0.18763796185985137654,0.81289525200956003204,0.38221212632527479247,-1.5708716061410068487,-3.1279175119084654533,0.96356640214777200537,-1.6405376243447697959,0.57123226926628023481,-2.2574603158038382134,-0.61579325399259687845,0.51120992333668180407,-0.82550398696781746022,-2.0868799502003736457,-0.30391656428853486283,2.9504007814157788836,-1.5969157872608557014,4.0446505245841271048,1.2279469217379586077,-1.6654888919139068104,1.3552017700198089045,0.98082800964599148319],[-2.2531244159463179599,0.24526196613259804158,-2.3950314969203643223,0.92561129298929767373,-1.3731066765444823741,0.47325879896967593119,-0.69885386470792076885,-1.5055032882340206868,-1.2432994845231484238,-0.50497824995753481936,1.6611957572265798611,0.48717920272086501221,0.37475363683814988391,-0.9989605985118189535,1.7453128875323085101,1.9941278451274955241,-2.169341202694146542,1.7963320822457000681,5.8563476545529091766,-3.1037336049252783887,-1.7402884359212007492,-0.099005571862299412977,-1.3677081959714456616,-0.36636827881280281671,-0.17570256466427799924,0.16577096831715393277,-0.0024129263916404901369],[-1.0410332401487232268,2.0998239637639066757,0.60026446792426846333,2.5177811947362500611,0.41588346902143941142,-0.67564526800888868863,-0.54441732003178555654,0.42429889596209868774,1.4947979425605770754,0.44166691538064800637,1.0778041262430302361,2.8968034318911706215,-0.25961821812417384958,1.0556060749227489381,0.75261869164738526283,-1.2587687115012233807,-2.1550048930904073252,-1.0979498804901048903,1.0164903326112231241,-5.462487377547492251,-1.9453760105617756704,0.45398262899175062524,-2.0235032059152011641,-0.95269713885046869439,0.11002239134542231291,2.6922731705017604042,-0.53536059911555888835],[0.33117242586693074191,-0.29447694073020952432,-0.14270032672234500559,1.0561367413097413337,-0.75086159077497727221,0.31469932770002717604,0.4236447133823987854,-0.44154320896453891354,1.2438287775885006337,0.17311148755629840457,-0.10636461820150627799,1.1340086322608180502,0.50130552603257061417,-0.27760943118996661561,-0.16819235007229396683,0.59141444782424312798,-0.32369495556211247411,0.92669268976991925335,0.70830110042470506571,-0.27050730144347778783,2.0298875409575658502,-0.31419267074936912953,-3.6246230059317836592,-2.155060117451665036,0.65762531057125406253,0.20079692145000088699,-1.4023658267645695563],[0.60673740812451337767,-1.2117282201963721633,1.1254119967771356592,0.84506508542993474808,0.54706031348611461329,0.36899178743130145453,-0.77123300795626392734,0.094909045802362923538,0.64841956687175550389,0.3498608485804866608,0.21782850879804260824,0.35862247662527863001,0.48409773413253753827,0.07172351696845681579,-0.25915439399726003522,-0.3258940378740135535,0.63386173440002224755,-0.39682964805425485766,0.29750014564796367633,0.42158797437231304572,-0.5877368415548558378,-0.36376425839252990446,-0.11557255253116643923,-0.070881853148671139508,0.10372070360074873985,0.64700075087342256985,-0.015791937646832870934],[-1.8844903549833134093,0.78146213438915179683,-0.4947846921813235932,1.0928744955084701562,1.0104458149486057472,0.44525422582461476884,0.37791273091577087806,0.62399179177285735154,0.96600092953769267634,1.0661618134251720225,-0.33776949051752086506,-0.13133875776564510329,0.023531032792143073695,-0.35018638353676201369,0.036484543585590500925,0.07652902489884544357,-1.8317538447040748739,-0.05810338348093424532,-1.2463437002345540972,-0.35456497519631002824,0.44620391865167857715,-1.3197049787275283439,0.87178699444751661662,-1.4511475432728442314,0.92884699135468873354,0.1954966113324364263,-0.68270612709746991698],[-0.87155474252359865783,3.4539803039287857445,-0.90642925730426082698,-1.0902697669525533986,-0.23589470548566171537,-0.23175559905254364268,0.7203449655492889514,-0.89612397660993636794,-3.8632655688833446028,-0.48606594757484206104,0.035928258854042778581,0.017101235575059128141,-0.083893909858218651543,2.7001878905372467266,0.65516327667665308354,-0.15032519434027361016,-0.14880263118155570568,0.38386776130532085372,-1.0591050831854516012,1.0186219599448729234,-3.2282403275604196757,-1.0619453370414739801,0.12273347853460225831,2.745279828797121624,0.22452773931626796022,-0.25502188404814324363,-0.65939258889079499504],[-2.0117115421859934621,-1.5578698906080536979,-0.93564369926126778054,1.3023573067880991339,0.68018631424695497056,-0.014449820733977169346,0.59487486338041273282,0.5877975431041642107,1.2996492460034951844,-0.24394182304623393542,-0.45372005141999754985,0.2377802361884712723,0.30871330866442225904,-0.22301984045346640029,-0.21745666649467301768,0.56289038599494534143,-3.0821954457287450424,-0.17532962759668696551,-0.9371566768972260375,-0.14569031039540047967,4.5440914622083763419,-0.87290795980863300496,0.53123214580040123423,-2.0360608297003266465,0.42720994187107652618,0.59189778850205054805,1.2245147197406602846],[0.92023074432890739072,-1.4915921383333103911,0.64599177071535285322,0.73458305148890257197,0.78457835304654321984,-0.19001824240361003815,-1.1777519046337936448,1.2763604152883349929,0.62545886360968372397,0.80524318903035163597,-0.26487917975038655083,0.42986422052341327626,0.4956839973409182809,-2.7154703957484160881,0.098364768023381954354,0.24528957037125828644,0.091822949697096950539,-0.24957644372669038346,0.70875479418424613964,-0.91335196043975053204,2.5439387403567788049,0.89738256981337960472,-0.17215069051783857268,-2.6284700300910182058,0.17020565102821744174,0.99240193440412083348,-0.94991078384260163592],[-0.75320624848497241821,3.3845163443009163018,4.1274840807305777091,0.61303207813105620172,3.2698035908599600852,1.6834579895838466257,-1.5014924136062843818,3.2224446962790365134,-0.22553147723003097447,1.1329028828804801332,1.4135194571919074136,0.684725352060678083,2.1884515708475467122,4.8368697380692502463,2.3046825891293778454,-2.7509389535303538921,0.75732153927231937729,-3.0276470216707540573,-3.4016476005804352489,1.9329700980175354985,2.5126494746979801675,-3.7918452612838140503,-0.54916330592584894355,-5.9721432542334582649,1.3940545431827102707,0.47261547606092046969,-4.3447068420477545914],[-0.54955058579937776653,-1.2202960028518152757,-0.26440498768222642223,0.55433614871525538348,0.54982099351096491713,0.16742787427792898969,-0.7840915329850360882,0.54688984296964460174,0.20364347780474961747,-0.11618762149023946495,0.18781244632404295314,-0.067150832493174689164,0.17407327321358359584,0.060149834119687536904,0.22283099760180677396,-0.02893488088580163653,0.55335438567008776722,0.013916322135248300473,-0.92475601356619230309,0.48033290636058562084,-0.69669400071726472756,-0.57903551791351126621,-1.0429551527407425748,-0.42664741649529647205,0.66349514177057278275,0.14433101537176049045,-0.76303917839276902413],[-0.52000864692232062758,2.2946263381800489078,-0.27543889928191006566,-0.096474722294365766739,-0.9151420034894364175,-1.3935361312313019333,0.4455956684663511802,-0.63567717539387680326,-0.70031508067631986769,0.23070505222058465544,-0.39141733079931578798,0.033467218826527783682,-1.3547172936234184171,2.4601760154492886556,-0.013092746650096305505,-2.0754908957671385217,1.8647313751359948508,-2.0261842023512968147,0.8693889363747815402,0.51299786636274691265,1.7481529559511632677,-0.75591436726375216271,1.5213420108009390042,-1.4127479065686003867,0.24050241554484280693,-0.709552519949588123,-0.76625549607713905331],[-0.5566145779520910164,2.5449652695124638235,-6.5010432020187991498,-1.1169190146002878627,3.1595714413562436818,-2.4499005182391493385,0.91261598356979478641,2.5544952156392306541,-1.7842515571493684501,-0.62166722756253234294,-1.7455138235091640642,-1.4600825133661845534,-2.6167852612451087957,-4.3621153968630235198,-1.9694463470537015848,1.2949515927019941142,-1.0467372856559267191,1.2106654377340808626,-1.8741757761382078495,-0.33439862472599757304,0.47976588087171267993,1.1752532395482269134,2.5639922532471284278,-0.38843115630565183682,-0.95219218489395673899,-1.486243946395019,1.2571417445235899546]]]
b2 = [-0.55233857546831033325, 0.72779675044216185498]
LW2_1 = [[-1.4381943606637190847,-0.82344621182830646244,1.6794659451523243909,-0.87825384130414585471,0.84570819676965691691,0.9655187472365419632,2.2100345284020193048,-0.47761045863187495675,-1.5545609554118005047,-1.0801314248434690235,3.9845905668882366513,0.76658491663802130756,2.227553720722827979,1.0455206901396552066,1.6344787899414137122,-1.5011180295284045627,0.50811107792182819143,-1.3020817572695615461,2.2749408742665990779,-1.816529777168264248],
         [0.80191537429509163193,-1.7635060255605012891,3.5556043647318431589,3.5196981134647278289,3.8212318742122555193,0.97006596229114305796,-2.4911205363768518239,-0.98176469121439768895,-1.3029723971508988534,0.74839723802214985771,-2.5470935717918692376,1.3184755678399773249,3.1327999286517478339,2.9957327520102237095,-3.766590545338226903,3.47058078123442737,-8.685114383442716246,-1.4271099851135220504,-1.0981324886026115895,-8.4909010822560340159]]

y1_step1 = [{"ymin": -1,
      "gain": 0.752728641324802,
      "xoffset": 0.001
      },
        {
            "ymin":-1,
            "gain":0.614817091915155,
            "xoffset":0.001
        }]

for i in range(0,2):
    x1_step1[i]["xoffset"] = np.array(x1_step1[i]["xoffset"]).reshape(len(x1_step1[i]["xoffset"]), 1)
    x1_step1[i]["gain"] = np.array(x1_step1[i]["gain"]).reshape(len(x1_step1[i]["gain"]), 1)

    x1_step1[i]["ymin"] = np.array(x1_step1[i]["ymin"])
    b1[i] = np.array(b1[i])
    IW1_1[i] = np.array(IW1_1[i])
    LW2_1[i] = np.array(LW2_1[i])
    LW2_1[i] = LW2_1[i].reshape(len(LW2_1[i]), 1)

def mapminmax_apply(x, settings):

    y = np.subtract(x, settings['xoffset'])
    y = np.multiply(y, settings['gain'])
    y = y + settings['ymin']
    return y

def tansig_apply(n):

    n = np.array(n)
    n = (1 + np.exp(-2 * n))
    n = np.divide(2, n)
    n = n - 1
    return n

def mapminmax_reverse(y,settings):

    x = np.subtract(y, settings['ymin'])
    x = np.divide(x, settings['gain'])
    x = x + settings['xoffset']
    return x

def removeconstantrows_apply(stats):

    result = []
    for stat in stats_to_keep:
        result.append(stats[int(stat)])
    return result

if __name__ == '__main__':

    #if this fails try to change the os.popen paramater for this scripts location in demo.py, called path
    '''
    arg[0] is the script name
    arg[1] is the core number stats are from
    arg[2] is the stats json format
    '''
    core = int(sys.argv[1])

    x1 = json.loads(sys.argv[2])

    if core == 1:
        x1 = removeconstantrows_apply(x1)

    x1 = np.array(x1)

    if type(x1[0]) is not list:
        Q = 1
    else:
        Q = x1.shape[1]

    x1 = np.transpose(x1.reshape(Q,x1.shape[0]))

    xp1 = mapminmax_apply(x1, x1_step1[core])

    xp1 = np.array(xp1)


    p1 = np.matlib.repmat(b1[core], 1, Q)
    a1 = tansig_apply(p1 + np.dot(IW1_1[core], xp1))


    LW2_1 = np.transpose(LW2_1[core])
    a2 = np.matlib.repmat(b2[core], 1, Q) + np.dot(LW2_1[0], a1)


    y1 = mapminmax_reverse(a2, y1_step1[0])

    y1 = np.transpose(y1)

    y1 = y1.tolist()

    y1 = json.dumps(y1, separators=(',', ':'))

    if '.' in y1 or ',' in y1:
        y1 = y1[2:-3]
    else:
        y1 = 0

    print y1








